import React, { useState, useEffect, useMemo, useCallback } from 'react';

// --- Пойгоҳи додаҳои саволҳо ---
const questionsData = {
   '5': [
    { id: 1, type: 'logic', question: 'Агар дирӯз якшанбе бошад, пас аз пагоҳ кадом рӯз меояд?', options: ['Сешанбе', 'Чоршанбе', 'Панҷшанбе', 'Душанбе'], answer: 'Сешанбе', explanation: 'Агар дирӯз якшанбе бошад, имрӯз душанбе аст. Пагоҳ сешанбе мешавад.' },
    { id: 2, type: 'calculation', question: '5 * (3 + 2) = ?', options: ['25', '10', '15', '30'], answer: '25', explanation: 'Аввал амали дар дохили қавс иҷро мешавад: 3 + 2 = 5. Баъд зарб: 5 * 5 = 25.' },
    { id: 3, type: 'geometry', question: 'Периметри квадрате, ки як тарафаш 4 см аст, чанд аст?', options: ['8 см', '12 см', '16 см', '20 см'], answer: '16 см', explanation: 'Периметри квадрат P = 4 * a. P = 4 * 4 = 16 см.' },
    { id: 4, type: 'calculation', question: '100 - (5 * 10) + 20 = ?', options: ['70', '50', '80', '60'], answer: '70', explanation: '100 - 50 + 20 = 50 + 20 = 70.' },
    { id: 5, type: 'logic', question: 'Дар як пойга шумо аз давандаи дуюм пеш гузаштед. Шумо ҳоло дар кадом ҷой ҳастед?', options: ['Якум', 'Дуюм', 'Сеюм', 'Охирон'], answer: 'Дуюм', explanation: 'Шумо ҷои давандаи дуюмро гирифтед, бинобар ин шумо дуюм ҳастед.' },
    { id: 6, type: 'geometry', question: 'Масоҳати росткунҷае, ки дарозиаш 8 см ва бараш 5 см аст, чанд аст?', options: ['13 см²', '26 см²', '40 см²', '45 см²'], answer: '40 см²', explanation: 'Масоҳати росткунҷа S = a * b. S = 8 * 5 = 40 см².' },
    { id: 7, type: 'calculation', question: 'Аҳмад 15 конфет дошт. Ӯ 4-тоашро хӯрд ва 3-тоашро ба дӯсташ дод. Ӯ чанд конфет боқӣ монд?', options: ['7', '8', '11', '12'], answer: '8', explanation: '15 - 4 - 3 = 8 конфет боқӣ монд.' },
    { id: 8, type: 'logic', question: 'Кадомаш вазнинтар аст: 1 кг пахта ё 1 кг оҳан?', options: ['Пахта', 'Оҳан', 'Ҳарду баробаранд', 'Гуфтан ғайриимкон аст'], answer: 'Ҳарду баробаранд', explanation: '1 кг ҳамеша 1 кг аст, новобаста аз он ки чӣ гуна мавод аст.' },
    { id: 9, type: 'calculation', question: '48 / (2 * 3) = ?', options: ['6', '8', '12', '24'], answer: '8', explanation: '48 / 6 = 8.' },
    { id: 10, type: 'geometry', question: 'Як соат чанд сония дорад?', options: ['60', '120', '3600', '360'], answer: '3600', explanation: 'Як соат 60 дақиқа дорад ва ҳар як дақиқа 60 сония дорад. 60 * 60 = 3600 сония.' },
    { id: 11, type: 'logic', question: 'Падари Марям 5 духтар дорад: Лола, Лайло, Лутфия, Латофат. Номи духтари панҷум чист?', options: ['Лилия', 'Марям', 'Зебо', 'Номаълум'], answer: 'Марям', explanation: 'Савол дар бораи падари Марям аст, пас Марям духтари панҷум аст.' },
    { id: 12, type: 'calculation', question: 'Суммаи рақамҳои аз 1 то 5 чанд аст?', options: ['10', '12', '15', '20'], answer: '15', explanation: '1 + 2 + 3 + 4 + 5 = 15.' },
    { id: 13, type: 'geometry', question: 'Чанд тараф дорад куб?', options: ['4', '6', '8', '12'], answer: '6', explanation: 'Куб 6 рӯя (тараф) дорад.' },
    { id: 14, type: 'calculation', question: 'Калонтарин адади дурақама кадом аст?', options: ['90', '98', '99', '100'], answer: '99', explanation: 'Адади калонтарини дурақама 99 мебошад.' },
    { id: 15, type: 'logic', question: 'Ду тангаи 50-дирама чанд сомонӣ мешавад?', options: ['1 сомонӣ', '2 сомонӣ', '50 дирам', '100 сомонӣ'], answer: '1 сомонӣ', explanation: '50 дирам + 50 дирам = 100 дирам, ки ба 1 сомонӣ баробар аст.' },
    { id: 16, type: 'calculation', question: '3 * 3 * 3 = ?', options: ['9', '18', '27', '33'], answer: '27', explanation: '3 * 3 = 9, ва 9 * 3 = 27.' },
    { id: 17, type: 'geometry', question: 'Шакле, ки 3 кунҷ ва 3 тараф дорад, чӣ ном дорад?', options: ['Квадрат', 'Ромб', 'Доира', 'Секунҷа'], answer: 'Секунҷа', explanation: 'Секунҷа шакли геометрии дорои се кунҷ ва се тараф аст.' },
    { id: 18, type: 'logic', question: 'Дар як моҳ ҳадди аксар чанд рӯзи якшанбе шуда метавонад?', options: ['3', '4', '5', '6'], answer: '5', explanation: 'Агар моҳ 30 ё 31 рӯз дошта бошад ва аз рӯзи ҷумъа, шанбе ё якшанбе оғоз шавад, он метавонад 5 якшанбе дошта бошад.' },
    { id: 19, type: 'calculation', question: '25 * 4 + 50 = ?', options: ['100', '150', '200', '120'], answer: '150', explanation: '25 * 4 = 100, ва 100 + 50 = 150.' },
    { id: 20, type: 'geometry', question: 'Агар соат 3:00-ро нишон диҳад, кунҷи байни ақрабакҳои соат ва дақиқа чанд градус аст?', options: ['45°', '60°', '90°', '180°'], answer: '90°', explanation: 'Дар соати 3:00, ақрабаки соат ба 3 ва ақрабаки дақиқа ба 12 ишора мекунад, ки кунҷи ростро (90°) ташкил медиҳад.' },
  ],
  '6': [
    { id: 1, type: 'algebra', question: 'Агар 2x + 3 = 11 бошад, x ба чанд баробар аст?', options: ['3', '4', '5', '6'], answer: '4', explanation: '2x = 11 - 3 => 2x = 8 => x = 8 / 2 => x = 4.' },
    { id: 2, type: 'logic', question: 'Дар як сабад 5 себи сурх ва 3 себи сабз ҳаст. Барои боварӣ ҳосил кардан, ки ҳадди аққал як себи сурх гирифтаед, чанд себро бояд тасодуфан гиред?', options: ['1', '3', '4', '5'], answer: '4', explanation: 'Дар ҳолати бадтарин, шумо аввал 3 себи сабзро мегиред. Себи чорум ҳатман сурх хоҳад буд.' },
    { id: 3, type: 'fraction', question: '1/2 + 1/4 = ?', options: ['1/6', '2/6', '3/4', '1/3'], answer: '3/4', explanation: 'Барои ҷамъ кардани касрҳо, махраҷи умумӣ ёфтан лозим аст. 1/2 = 2/4. Пас, 2/4 + 1/4 = 3/4.' },
    { id: 4, type: 'percentage', question: '20% -и 150 чанд мешавад?', options: ['20', '30', '40', '50'], answer: '30', explanation: '150 * (20 / 100) = 150 * 0.20 = 30.' },
    { id: 5, type: 'algebra', question: '3y - 5 = 10. `y`-ро ёбед.', options: ['3', '5', '7', '15'], answer: '5', explanation: '3y = 10 + 5 => 3y = 15 => y = 15 / 3 = 5.' },
    { id: 6, type: 'geometry', question: 'Кунҷи дохилии секунҷаи баробартарафа чанд градус аст?', options: ['45°', '60°', '90°', '180°'], answer: '60°', explanation: 'Ҳамаи кунҷҳои секунҷаи баробартарафа баробаранд ва маҷмӯи онҳо 180° аст. 180 / 3 = 60°.' },
    { id: 7, type: 'calculation', question: 'Нархи китоб 40 сомонӣ буд. Он 10% арзон шуд. Нархи нави китоб чанд аст?', options: ['30 сомонӣ', '34 сомонӣ', '36 сомонӣ', '44 сомонӣ'], answer: '36 сомонӣ', explanation: '10% аз 40 ин 4 сомонӣ аст. 40 - 4 = 36 сомонӣ.' },
    { id: 8, type: 'logic', question: 'Агар 5 мошин дар 5 дақиқа 5 қисм истеҳсол кунанд, 100 мошин дар 100 дақиқа чанд қисм истеҳсол мекунад?', options: ['5', '100', '500', '2000'], answer: '2000', explanation: '1 мошин дар 5 дақиқа 1 қисм истеҳсол мекунад. Пас 1 мошин дар 100 дақиқа (100/5)=20 қисм истеҳсол мекунад. 100 мошин дар 100 дақиқа 100 * 20 = 2000 қисм истеҳсол мекунад.' },
    { id: 9, type: 'calculation', question: 'Адади соддаи калонтарини аз 20 хурд кадом аст?', options: ['15', '17', '19', '20'], answer: '19', explanation: 'Ададҳои содда ададҳое мебошанд, ки танҳо ба 1 ва худашон тақсим мешаванд. 19 адади содда аст.' },
    { id: 10, type: 'fraction', question: '3/5 аз 25 чанд аст?', options: ['5', '10', '15', '20'], answer: '15', explanation: '(25 / 5) * 3 = 5 * 3 = 15.' },
    { id: 11, type: 'algebra', question: 'x / 4 = 5. x-ро ёбед.', options: ['1', '9', '20', '1.25'], answer: '20', explanation: 'x = 5 * 4 = 20.' },
    { id: 12, type: 'geometry', question: 'Агар периметри квадрат 36 см бошад, дарозии як тарафи он чанд аст?', options: ['6 см', '9 см', '12 см', '18 см'], answer: '9 см', explanation: 'P = 4 * a => 36 = 4 * a => a = 36 / 4 = 9 см.' },
    { id: 13, type: 'percentage', question: 'Дар синф 25 хонанда ҳаст, ки 40% -и онҳо духтарон мебошанд. Дар синф чанд писар ҳаст?', options: ['10', '12', '15', '18'], answer: '15', explanation: 'Духтарон: 25 * 0.40 = 10 нафар. Писарон: 25 - 10 = 15 нафар.' },
    { id: 14, type: 'percentage', question: ' Таксимкунандаи умумии калонтарини ададҳои 12 ва 18-ро ёбед.', options: ['2', '3', '6', '9'], answer: '6', explanation: 'Таксимкунандаҳои 12: 1,2,3,4,6,12. Таксимкунандаҳои 18: 1,2,3,6,9,18. Калонтаринаш 6 аст.' },
    { id: 15, type: 'logic', question: 'Поезд аз Душанбе соати 14:30 баромад ва пас аз 3 соату 45 дақиқа ба Хуҷанд расид. Поезд соат чанд ба Хуҷанд расид?', options: ['17:15', '17:45', '18:00', '18:15'], answer: '18:15', explanation: '14:30 + 3 соат = 17:30. 17:30 + 45 дақиқа = 18:15.' },
    { id: 16, type: 'fraction', question: '2 - 3/4 = ?', options: ['1/4', '1 ва 1/4', '5/4', '1'], answer: '1 ва 1/4', explanation: '2-ро ҳамчун 8/4 менависем. 8/4 - 3/4 = 5/4, ки ба 1 ва 1/4 баробар аст.' },
    { id: 17, type: 'algebra', question: 'Агар a=5 ва b=2 бошад, 2a + 3b чанд аст?', options: ['11', '13', '16', '20'], answer: '16', explanation: '2*(5) + 3*(2) = 10 + 6 = 16.' },
    { id: 18, type: 'geometry', question: 'Маҷмӯи кунҷҳои дохилии чоркунҷа чанд градус аст?', options: ['90°', '180°', '270°', '360°'], answer: '360°', explanation: 'Маҷмӯи кунҷҳои дохилии дилхоҳ чоркунҷаи барҷаста 360° аст.' },
    { id: 19, type: 'calculation', question: '12 * 11 = ?', options: ['112', '121', '132', '144'], answer: '132', explanation: '12 * 10 = 120. 120 + 12 = 132.' },
    { id: 20, type: 'logic', question: 'Агар 5 гурба 5 мушро дар 5 дақиқа дошта тавонанд, барои доштани 100 муш дар 100 дақиқа чанд гурба лозим аст?', options: ['5', '20', '50', '100'], answer: '5', explanation: 'Аз шарти аввал, 1 гурба 1 мушро дар 5 дақиқа медорад. Пас, ҳамон 1 гурба дар 100 дақиқа 20 муш медорад. Барои доштани 100 муш, 100/20 = 5 гурба лозим аст.' },
  ],
  '7': [
    { id: 1, type: 'geometry', question: 'Масоҳати доирае, ки радиусаш 5 см аст, чанд аст? (π ≈ 3.14)', options: ['78.5 см²', '15.7 см²', '31.4 см²', '50 см²'], answer: '78.5 см²', explanation: 'Масоҳати доира S = π * r². S = 3.14 * 5² = 3.14 * 25 = 78.5 см².' },
    { id: 2, type: 'algebra', question: '(x + 5)(x - 2) -ро содда кунед.', options: ['x² + 3x - 10', 'x² - 3x - 10', 'x² + 7x + 10', 'x² - 10'], answer: 'x² + 3x - 10', explanation: 'x*x + x*(-2) + 5*x + 5*(-2) = x² - 2x + 5x - 10 = x² + 3x - 10.' },
    { id: 3, type: 'geometry', question: 'Дарозии доирае, ки диаметри он 10 см аст, чанд аст? (π ≈ 3.14)', options: ['15.7 см', '31.4 см', '62.8 см', '78.5 см'], answer: '31.4 см', explanation: 'Дарозии доира C = π * d. C = 3.14 * 10 = 31.4 см.' },
    { id: 4, type: 'equations', question: 'Системаи муодиларо ҳал кунед: x + y = 7 ва x - y = 3.', options: ['x=4, y=3', 'x=3, y=4', 'x=5, y=2', 'x=2, y=5'], answer: 'x=5, y=2', explanation: 'Ду муодиларо ҷамъ мекунем: (x+y)+(x-y) = 7+3 => 2x = 10 => x=5. Пас y = 7-x = 7-5 = 2.' },
    { id: 5, type: 'ratio', question: 'Таносуби писарон ба духтарон дар синф 3:2 аст. Агар дар синф 30 хонанда бошад, чанд писар ҳаст?', options: ['10', '12', '15', '18'], answer: '18', explanation: 'Ҳамагӣ 3+2=5 ҳисса. 30/5 = 6 нафар дар як ҳисса. Писарон: 3 * 6 = 18 нафар.' },
    { id: 6, type: 'algebra', question: 'Арзиши ифодаи 3a² - 2b, агар a=3 ва b=4 бошад, чанд аст?', options: ['19', '23', '10', '15'], answer: '19', explanation: '3 * (3²) - 2 * 4 = 3 * 9 - 8 = 27 - 8 = 19.' },
    { id: 7, type: 'geometry', question: 'Ҳаҷми кубе, ки як қиррааш 4 см аст, чанд аст?', options: ['12 см³', '16 см³', '48 см³', '64 см³'], answer: '64 см³', explanation: 'Ҳаҷми куб V = a³. V = 4³ = 64 см³.' },
    { id: 8, type: 'powers', question: '2⁵ = ?', options: ['10', '16', '25', '32'], answer: '32', explanation: '2 * 2 * 2 * 2 * 2 = 32.' },
    { id: 9, type: 'logic', question: 'Суръати миёнаи мошине, ки 120 км-ро дар 2 соат тай мекунад, чанд аст?', options: ['40 км/соат', '60 км/соат', '80 км/соат', '120 км/соат'], answer: '60 км/соат', explanation: 'Суръат = Масофа / Вақт. 120 км / 2 соат = 60 км/соат.' },
    { id: 10, type: 'equations', question: 'Решаи муодилаи 5(x - 1) = 20-ро ёбед.', options: ['3', '4', '5', '6'], answer: '5', explanation: 'x - 1 = 20 / 5 => x - 1 = 4 => x = 4 + 1 = 5.' },
    { id: 11, type: 'percentage', question: 'Ададе, ки 25%-и он 10 аст, кадом аст?', options: ['2.5', '25', '40', '50'], answer: '40', explanation: 'Агар 25% = 10 бошад, пас 100% = 10 * 4 = 40.' },
    { id: 12, type: 'algebra', question: 'x * x * x-ро ҳамчун дараҷа нависед.', options: ['3x', 'x+3', 'x³', 'x/3'], answer: 'x³', explanation: 'Зарби секаратаи x ба худаш x-и мукааб (x³) аст.' },
    { id: 13, type: 'geometry', question: 'Дар секунҷаи росткунҷа катетҳо 3 ва 4 мебошанд. Гипотенузаро ёбед.', options: ['5', '6', '7', '8'], answer: '5', explanation: 'Мувофиқи теоремаи Пифагор: c² = a² + b² => c² = 3² + 4² = 9 + 16 = 25 => c = 5.' },
    { id: 14, type: 'calculation', question: '(-5) + (-8) = ?', options: ['-3', '3', '-13', '13'], answer: '-13', explanation: 'Ҷамъи ду адади манфӣ адади манфӣ аст.' },
    { id: 15, type: 'logic', question: 'Се нафар дӯстон 21 конфетро баробар тақсим карданд. Ба ҳар кадоми онҳо чанд конфет расид?', options: ['5', '6', '7', '8'], answer: '7', explanation: '21 / 3 = 7.' },
    { id: 16, type: 'equations', question: 'Агар x/3 + 2 = 5 бошад, x чанд аст?', options: ['3', '6', '9', '12'], answer: '9', explanation: 'x/3 = 5 - 2 => x/3 = 3 => x = 3 * 3 = 9.' },
    { id: 17, type: 'ratio', question: 'Дар харита масофаи 1 см ба 10 км дар воқеият мувофиқат мекунад. Масофаи 5.5 см дар харита дар воқеият чанд км аст?', options: ['15.5 км', '50 км', '55 км', '550 км'], answer: '55 км', explanation: '5.5 см * 10 км/см = 55 км.' },
    { id: 18, type: 'geometry', question: 'Кунҷи ҳамсоя бо кунҷи 70° чанд градус аст?', options: ['20°', '90°', '110°', '290°'], answer: '110°', explanation: 'Маҷмӯи кунҷҳои ҳамсоя 180° аст. 180° - 70° = 110°.' },
    { id: 19, type: 'powers', question: '10³ - 10² = ?', options: ['10', '90', '900', '990'], answer: '900', explanation: '1000 - 100 = 900.' },
    { id: 20, type: 'algebra', question: 'Ифодаро содда кунед: 4a - 2b + a + 5b', options: ['4a + 3b', '5a + 3b', '5a - 7b', '4a - 3b'], answer: '5a + 3b', explanation: '(4a + a) + (-2b + 5b) = 5a + 3b.' },
  ],
  '8': [
    { id: 1, type: 'equations', question: 'Муодилаи квадратии x² - 5x + 6 = 0 -ро ҳал кунед.', options: ['x=1, x=6', 'x=2, x=3', 'x=-2, x=-3', 'x=-1, x=-6'], answer: 'x=2, x=3', explanation: 'Мувофиқи теоремаи Виет, x1+x2=5 ва x1*x2=6. Решаҳо 2 ва 3 мебошанд.' },
    { id: 2, type: 'geometry', question: 'Дар секунҷаи росткунҷа катет 6 см ва гипотенуза 10 см аст. Катети дуюмро ёбед.', options: ['4 см', '5 см', '7 см', '8 см'], answer: '8 см', explanation: 'b² = c² - a² => b² = 10² - 6² = 100 - 36 = 64 => b = 8 см.' },
    { id: 3, type: 'algebra', question: '√64 + √25 = ?', options: ['√89', '13', '15', '10'], answer: '13', explanation: '8 + 5 = 13.' },
    { id: 4, type: 'logic', question: 'Мошин бо суръати 80 км/соат ҳаракат мекунад. Он дар 90 дақиқа чӣ қадар масофаро тай мекунад?', options: ['80 км', '90 км', '120 км', '160 км'], answer: '120 км', explanation: '90 дақиқа = 1.5 соат. Масофа = 80 км/соат * 1.5 соат = 120 км.' },
    { id: 5, type: 'equations', question: 'Системаи муодилаҳоро ҳал кунед: 2x + y = 8 ва x - y = 1.', options: ['x=3, y=2', 'x=2, y=4', 'x=4, y=0', 'x=5, y=-2'], answer: 'x=3, y=2', explanation: 'Ду муодиларо ҷамъ мекунем: 3x = 9 => x=3. Он гоҳ y = x - 1 = 3 - 1 = 2.' },
    { id: 6, type: 'geometry', question: 'Масоҳати трапетсияе, ки асосҳояш 8 см ва 12 см ва баландиаш 5 см аст, чанд аст?', options: ['45 см²', '50 см²', '60 см²', '100 см²'], answer: '50 см²', explanation: 'S = ((a+b)/2) * h = ((8+12)/2) * 5 = (20/2) * 5 = 10 * 5 = 50 см².' },
    { id: 7, type: 'algebra', question: 'Ифодаро содда кунед: (a - b)² + 2ab', options: ['a² + b²', 'a² - b²', 'a² - 2ab + b²', 'a² + 2ab + b²'], answer: 'a² + b²', explanation: '(a² - 2ab + b²) + 2ab = a² + b².' },
    { id: 8, type: 'powers', question: '(3²)³ = ?', options: ['3⁵', '3⁶', '9³', '27'], answer: '3⁶', explanation: '(3²)³ = 3^(2*3) = 3⁶ = 729.' },
    { id: 9, type: 'logic', question: 'Аз 50 донишҷӯ, 30 нафар футболбозӣ мекунанд, 25 нафар волейбол. 10 нафар ҳардуро бозӣ мекунанд. Чанд нафар умуман бозӣ намекунанд?', options: ['0', '5', '10', '15'], answer: '5', explanation: 'Танҳо футбол: 30-10=20. Танҳо волейбол: 25-10=15. Ҳамагӣ бозигарон: 20+15+10 = 45. Бозӣ намекунанд: 50 - 45 = 5.' },
    { id: 10, type: 'fraction', question: '(2/3) / (4/9) = ?', options: ['1/2', '8/27', '3/2', '2/3'], answer: '3/2', explanation: '(2/3) * (9/4) = 18/12 = 3/2.' },
    { id: 11, type: 'geometry', question: 'Диагонали квадрате, ки тарафаш 5 см аст, чанд аст?', options: ['5√2 см', '5 см', '10 см', '2√5 см'], answer: '5√2 см', explanation: 'd² = a² + a² = 2a². d = a√2 = 5√2 см.' },
    { id: 12, type: 'equations', question: '|x - 3| = 5. x-ро ёбед.', options: ['x=8', 'x=-2', 'x=8 ё x=-2', 'x=2'], answer: 'x=8 ё x=-2', explanation: 'x - 3 = 5 => x = 8. ё x - 3 = -5 => x = -2.' },
    { id: 13, type: 'algebra', question: 'Графики функсияи y = 2x + 1 тири OY-ро дар кадом нуқта мебурад?', options: ['(0, 1)', '(1, 0)', '(0.5, 0)', '(0, 2)'], answer: '(0, 1)', explanation: 'Вақте ки график тири OY-ро мебурад, x=0. y = 2(0) + 1 = 1. Нуқта (0, 1) аст.' },
    { id: 14, type: 'percentage', question: 'Нархи мол 20% боло рафт ва баъдан 20% поён фаромад. Нархи ниҳоӣ нисбат ба нархи аввала чӣ гуна тағйир ёфт?', options: ['Тағйир наёфт', '1% боло рафт', '4% арзон шуд', '4% қимат шуд'], answer: '4% арзон шуд', explanation: 'Бигзор нарх 100 бошад. 100*1.20 = 120. 120*0.80 = 96. Нарх 4% арзон шуд.' },
    { id: 15, type: 'powers', question: '4⁻² = ?', options: ['-8', '-16', '1/8', '1/16'], answer: '1/16', explanation: '4⁻² = 1 / 4² = 1/16.' },
    { id: 16, type: 'geometry', question: 'Медианаи ба гипотенуза гузаронидашудаи секунҷаи росткунҷа ба ... баробар аст.', options: ['катет', 'баланди', 'нисфи гипотенуза', 'биссектриса'], answer: 'нисфи гипотенуза', explanation: 'Ин хосияти секунҷаи росткунҷа аст.' },
    { id: 17, type: 'algebra', question: 'Ифодаи 16x² - 25-ро ба зарбкунандаҳо ҷудо кунед.', options: ['(4x - 5)(4x + 5)', '(4x - 5)²', '(16x-1)(x+25)', '(8x-5)(2x+5)'], answer: '(4x - 5)(4x + 5)', explanation: 'Ин формулаи фарқи квадратҳост: a²-b²=(a-b)(a+b).' },
    { id: 18, type: 'logic', question: 'Суммаи ду адад 25 ва фарқи онҳо 5 аст. Ин ададҳоро ёбед.', options: ['10 ва 15', '12 ва 13', '5 ва 20', '8 ва 17'], answer: '10 ва 15', explanation: 'x+y=25, x-y=5. Ҷамъ мекунем: 2x=30 => x=15. y=10.' },
    { id: 19, type: 'equations', question: 'x² = 144. x-ро ёбед.', options: ['12', '-12', '12 ва -12', '72'], answer: '12 ва -12', explanation: 'Решаи квадратии 144 ҳам 12 ва ҳам -12 аст.' },
    { id: 20, type: 'geometry', question: 'Кунҷи марказии доира 60° аст. Ин кунҷ ба кадоме аз камони доира такя мекунад?', options: ['1/3', '1/4', '1/5', '1/6'], answer: '1/6', explanation: 'Тамоми доира 360° аст. 60°/360° = 1/6.' },
  ],
  '9': [
    { id: 1, type: 'quadratics', question: 'Дискриминанти муодилаи 2x² - 7x + 3 = 0 -ро ёбед.', options: ['25', '49', '1', '73'], answer: '25', explanation: 'D = b²-4ac = (-7)²-4*2*3 = 49-24 = 25.' },
    { id: 2, type: 'trigonometry', question: 'Дар секунҷаи росткунҷа бо кунҷи 30°, катети муқобили ин кунҷ ба ... баробар аст.', options: ['катети дигар', 'гипотенуза', 'нисфи гипотенуза', 'дучанди гипотенуза'], answer: 'нисфи гипотенуза', explanation: 'sin(30°) = 1/2. Ин хосияти секунҷаи росткунҷа бо кунҷи 30° аст.' },
    { id: 3, type: 'series', question: 'Суммаи 5 аъзои аввали прогрессияи арифметикии an = 2n + 1-ро ёбед.', options: ['25', '30', '35', '40'], answer: '35', explanation: 'a1=3, a2=5, a3=7, a4=9, a5=11. Сумма = 3+5+7+9+11 = 35.' },
    { id: 4, type: 'geometry', question: 'Масоҳати ромбе, ки диагоналҳояш 10 ва 12 мебошанд, чанд аст?', options: ['30', '60', '110', '120'], answer: '60', explanation: 'S = (d1 * d2) / 2 = (10 * 12) / 2 = 120 / 2 = 60.' },
    { id: 5, type: 'inequalities', question: 'Нобаробарии 3x - 6 > 9 -ро ҳал кунед.', options: ['x > 1', 'x < 5', 'x > 5', 'x < 1'], answer: 'x > 5', explanation: '3x > 9 + 6 => 3x > 15 => x > 5.' },
    { id: 6, type: 'functions', question: 'Қуллаи параболаи y = (x - 2)² + 3 дар кадом нуқта ҷойгир аст?', options: ['(-2, 3)', '(2, 3)', '(2, -3)', '(-2, -3)'], answer: '(2, 3)', explanation: 'Формулаи умумӣ y = a(x - h)² + k аст, ки дар он (h, k) қулла аст.' },
    { id: 7, type: 'vectors', question: 'Вектори AB-ро ёбед, агар A(1, 3) ва B(5, 7) бошад.', options: ['(4, 4)', '(6, 10)', '(4, 10)', '(-4, -4)'], answer: '(4, 4)', explanation: 'AB = (xB - xA, yB - yA) = (5 - 1, 7 - 3) = (4, 4).' },
    { id: 8, type: 'series', question: 'Махраҷи прогрессияи геометрии 2, 6, 18, ... чанд аст?', options: ['2', '3', '4', '6'], answer: '3', explanation: 'q = b2 / b1 = 6 / 2 = 3.' },
    { id: 9, type: 'trigonometry', question: 'sin²α + cos²α = ?', options: ['0', '1', '2', 'tgα'], answer: '1', explanation: 'Ин айнияти асосии тригонометрӣ аст.' },
    { id: 10, type: 'geometry', question: 'Ду хати рост параллеланд, агар кунҷҳои дохилии яктарафа ...', options: ['баробар бошанд', 'ҷамъи онҳо 90° бошад', 'ҷамъи онҳо 180° бошад', 'вертикалӣ бошанд'], answer: 'ҷамъи онҳо 180° бошад', explanation: 'Ин яке аз аломатҳои параллелии хатҳои рост аст.' },
    { id: 11, type: 'quadratics', question: 'Агар решаҳои муодилаи квадратӣ 4 ва -1 бошанд, муодила кадом аст?', options: ['x²+3x-4=0', 'x²-3x-4=0', 'x²-5x+4=0', 'x²+5x+4=0'], answer: 'x²-3x-4=0', explanation: 'x1+x2 = 3 = -b/a. x1*x2 = -4 = c/a. Муодила: x² - 3x - 4 = 0.' },
    { id: 12, type: 'logic', question: 'Эҳтимолияти омадани рақами "6" ҳангоми партофтани зор (мукааб) чанд аст?', options: ['1/2', '1/3', '1/5', '1/6'], answer: '1/6', explanation: 'Зор 6 рӯя дорад ва танҳо яке аз онҳо "6" аст.' },
    { id: 13, type: 'percentage', question: 'Ифодаро содда кунед: (x³ * x⁵) / x².', options: ['x⁴', 'x⁵', 'x⁶', 'x¹⁰'], answer: 'x⁶', explanation: 'x^(3+5-2) = x⁶.' },
    { id: 14, type: 'functions', question: 'Соҳаи муайянии функсияи y = √(x-4) кадом аст?', options: ['x > 4', 'x ≥ 4', 'x < 4', 'x ≠ 4'], answer: 'x ≥ 4', explanation: 'Ифодаи зери решаи квадратӣ бояд ғайриманфӣ бошад, яъне x-4 ≥ 0.' },
    { id: 15, type: 'geometry', question: 'Дар секунҷаи ABC кунҷи A=50°, B=70°. Кунҷи C-ро ёбед.', options: ['40°', '50°', '60°', '70°'], answer: '60°', explanation: 'Суммаи кунҷҳои секунҷа 180° аст. C = 180 - (50 + 70) = 180 - 120 = 60°.' },
    { id: 16, type: 'trigonometry', question: 'tg(45°) чанд аст?', options: ['0', '1/2', '√3/2', '1'], answer: '1', explanation: 'Дар 45°, катетҳои муқобил ва ҳамсоя баробаранд, бинобар ин тангенс 1 аст.' },
    { id: 17, type: 'series', question: 'Адади навбатии пайдарпайии 1, 4, 9, 16, 25, ... кадом аст?', options: ['30', '35', '36', '49'], answer: '36', explanation: 'Ин пайдарпайии квадратҳои ададҳои натуралӣ аст: 1², 2², 3², 4², 5², 6²=36.' },
    { id: 18, type: 'inequalities', question: 'x² < 9. Ҳалли нобаробариро ёбед.', options: ['x < 3', 'x > -3', '-3 < x < 3', 'x > 3 ё x < -3'], answer: '-3 < x < 3', explanation: 'Ин маънои онро дорад, ки масофа аз x то 0 аз 3 хурдтар аст.' },
    { id: 19, type: 'geometry', question: 'Радиуси давраи дар секунҷаи баробартарафаи тарафаш 6√3 кашидашударо ёбед.', options: ['3', '3√3', '6', '9'], answer: '3', explanation: 'r = a / (2√3) = 6√3 / (2√3) = 3.' },
    { id: 20, type: 'logic', question: 'Бо рақамҳои 1, 2, 3 чанд адади серақамаи гуногунрақам сохтан мумкин аст?', options: ['3', '6', '9', '27'], answer: '6', explanation: 'Ин ҷойивазкунӣ аз 3 элемент аст: P₃ = 3! = 1 * 2 * 3 = 6.' },
  ],

  '10': [
    { id: 1, type: 'logarithms', question: 'log₂(8) = ?', options: ['2', '3', '4', '16'], answer: '3', explanation: '2 ба дараҷаи 3 ба 8 баробар аст (2³ = 8).' },
    { id: 2, type: 'trigonometry', question: 'sin(2x) ба чӣ баробар аст?', options: ['2sinx', 'sin x + cos x', '2sinxcosx', 'cos²x - sin²x'], answer: '2sinxcosx', explanation: 'Ин формулаи синуси аргументи дучанд аст.' },
    { id: 3, type: 'series', question: 'Суммаи прогрессияи геометрии беохир камшавандаи 1 + 1/2 + 1/4 + ... -ро ёбед.', options: ['1.5', '2', '2.5', 'беохир'], answer: '2', explanation: 'S = b₁ / (1-q) = 1 / (1 - 1/2) = 1 / (1/2) = 2.' },
    { id: 4, type: 'stereometry', question: 'Ҳаҷми силиндре, ки радиуси асосаш 3 ва баландиаш 5 аст, чанд аст?', options: ['15π', '30π', '45π', '90π'], answer: '45π', explanation: 'V = πr²h = π * 3² * 5 = π * 9 * 5 = 45π.' },
    { id: 5, type: 'derivatives', question: 'Ҳосилаи функсияи f(x) = x³ -ро ёбед.', options: ['3x', '3x²', 'x²/2', '3x³'], answer: '3x²', explanation: 'Мувофиқи қоидаи ҳосилагирӣ аз функсияи дараҷагӣ (xⁿ)\' = nxⁿ⁻¹.' },
    { id: 6, type: 'logarithms', question: 'logₐa + logₐ1 = ?', options: ['a', '0', '1', 'a+1'], answer: '1', explanation: 'logₐa = 1 ва logₐ1 = 0. Пас 1 + 0 = 1.' },
    { id: 7, type: 'trigonometry', question: 'Даври асосии функсияи y = cos(x) кадом аст?', options: ['π/2', 'π', '2π', '4π'], answer: '2π', explanation: 'Функсияи косинус ҳар 2π радиан такрор мешавад.' },
    { id: 8, type: 'combinatorics', question: 'C⁵₂ (комбинатсия аз 5-ум 2-то) чанд аст?', options: ['10', '15', '20', '25'], answer: '10', explanation: 'C⁵₂ = 5! / (2! * (5-2)!) = 120 / (2 * 6) = 120 / 12 = 10.' },
    { id: 9, type: 'percentage', question: 'Ҳосилаи функсияи f(x) = 5x + sin(x) -ро ёбед.', options: ['5 + cos(x)', '5 - cos(x)', '1 + cos(x)', '5x + cos(x)'], answer: '5 + cos(x)', explanation: 'Ҳосилаи 5x ба 5 ва ҳосилаи sin(x) ба cos(x) баробар аст.' },
    { id: 10, type: 'stereometry', question: 'Диагонали кубе, ки қиррааш "a" аст, ба чӣ баробар аст?', options: ['a√2', 'a√3', '2a', '3a'], answer: 'a√3', explanation: 'd² = a² + a² + a² = 3a². d = a√3.' },
    { id: 11, type: 'logarithms', question: 'Нобаробарии log₂(x) > 3 -ро ҳал кунед.', options: ['x > 6', 'x < 8', 'x > 8', 'x > 9'], answer: 'x > 8', explanation: 'x > 2³. x > 8.' },
    { id: 12, type: 'trigonometry', question: 'Муодилаи cos(x) = 1/2 -ро дар порчаи [0, 2π] ҳал кунед.', options: ['π/3', 'π/3 ва 5π/3', 'π/6 ва 11π/6', 'π/4 ва 7π/4'], answer: 'π/3 ва 5π/3', explanation: 'Косинус дар чорякҳои I ва IV мусбат аст.' },
    { id: 13, type: 'series', question: 'Пайдарпаии an = (-1)ⁿ / n. a₃-ро ёбед.', options: ['1/3', '-1/3', '3', '-3'], answer: '-1/3', explanation: 'a₃ = (-1)³ / 3 = -1 / 3.' },
    { id: 14, type: 'derivatives', question: 'Маънои физикии ҳосилаи якум аз роҳ нисбат ба вақт чист?', options: ['Таъҷил', 'Қувва', 'Суръат', 'Энергия'], answer: 'Суръат', explanation: 'v(t) = s\'(t).' },
    { id: 15, type: 'stereometry', question: 'Масоҳати сатҳи пурраи кураи радиусаш R чанд аст?', options: ['πR²', '2πR²', '3πR²', '4πR²'], answer: '4πR²', explanation: 'Ин формулаи масоҳати сатҳи кура аст.' },
    { id: 16, type: 'logarithms', question: 'lg(1000) - lg(10) = ? (lg - логарифми даҳӣ)', options: ['2', '3', '10', '990'], answer: '2', explanation: '3 - 1 = 2.' },
    { id: 17, type: 'combinatorics', question: 'Бо чанд роҳ 4 китоби гуногунро дар раф ҷо ба ҷо гузоштан мумкин аст?', options: ['4', '12', '16', '24'], answer: '24', explanation: 'Ин ҷойивазкунӣ аз 4 элемент аст: P₄ = 4! = 1*2*3*4 = 24.' },
    { id: 18, type: 'trigonometry', question: 'cos(60°) + sin(30°) = ?', options: ['1', '√3/2', '√3', '1/2'], answer: '1', explanation: '1/2 + 1/2 = 1.' },
    { id: 19, type: 'derivatives', question: 'Нуқтаи экстремуми функсияи y = x² - 4x + 5 -ро ёбед.', options: ['x=1', 'x=2', 'x=3', 'x=4'], answer: 'x=2', explanation: 'y\' = 2x - 4. 2x - 4 = 0 => 2x = 4 => x = 2.' },
    { id: 20, type: 'stereometry', question: 'Ҳаҷми пирамидаи чоркунҷаи мунтазаме, ки тарафи асосаш 6 ва баландиаш 10 аст, чанд аст?', options: ['60', '120', '180', '360'], answer: '120', explanation: 'V = (1/3) * S_asоs * h = (1/3) * 6² * 10 = (1/3) * 36 * 10 = 12 * 10 = 120.' },
  ],
  '11': [
    { id: 1, type: 'integrals', question: 'Интеграли номуайяни ∫2x dx -ро ёбед.', options: ['x² + C', '2x² + C', 'x + C', '2 + C'], answer: 'x² + C', explanation: '∫xⁿ dx = (xⁿ⁺¹)/(n+1) + C. Пас ∫2x dx = 2 * (x²/2) + C = x² + C.' },
    { id: 2, type: 'derivatives', question: 'Ҳосилаи функсияи y = eˣ -ро ёбед.', options: ['xeˣ⁻¹', 'eˣ', 'ln(x)', '1'], answer: 'eˣ', explanation: 'Функсияи экспоненсиалӣ y = eˣ ягона функсияест, ки ҳосилааш ба худаш баробар аст.' },
    { id: 3, type: 'limits', question: 'Лимити lim (x→2) (x² - 4)/(x - 2) -ро ҳисоб кунед.', options: ['0', '2', '4', 'мавҷуд нест'], answer: '4', explanation: '(x² - 4)/(x - 2) = (x-2)(x+2)/(x-2) = x+2. lim(x→2) (x+2) = 2+2=4.' },
    { id: 4, type: 'stereometry', question: 'Ҳаҷми конусе, ки радиуси асосаш 3 ва баландиаш 4 аст, чанд аст?', options: ['9π', '12π', '16π', '36π'], answer: '12π', explanation: 'V = (1/3)πr²h = (1/3) * π * 3² * 4 = (1/3) * 9 * 4 * π = 12π.' },
    { id: 5, type: 'complex', question: 'i² ба чӣ баробар аст? (i - воҳиди мавҳум)', options: ['1', '-1', 'i', '-i'], answer: '-1', explanation: 'Мувофиқи таъриф, i = √-1, пас i² = -1.' },
    { id: 6, type: 'integrals', question: 'Интеграли муайяни ∫₀¹ 3x² dx -ро ҳисоб кунед.', options: ['0', '1', '2', '3'], answer: '1', explanation: '∫3x² dx = x³. F(1) - F(0) = 1³ - 0³ = 1.' },
    { id: 7, type: 'probability', question: 'Аз 10 тӯбчаи сафед ва 5 сиёҳ, эҳтимолияти тасодуфан гирифтани тӯбчаи сиёҳ чӣ қадар аст?', options: ['1/2', '1/3', '1/4', '1/5'], answer: '1/3', explanation: 'Ҳамагӣ 15 тӯбча. Тӯбчаҳои мусоид 5-то. P = 5/15 = 1/3.' },
    { id: 8, type: 'percentage', question: 'Ҳосилаи функсияи y = ln(x) -ро ёбед.', options: ['x', '1/x', 'eˣ', '-1/x²'], answer: '1/x', explanation: 'Ин формулаи асосии ҳосилагирӣ аст.' },
    { id: 9, type: 'limits', question: 'Лимити lim (n→∞) (1/n) -ро ҳисоб кунед.', options: ['∞', '1', '0', 'мавҷуд нест'], answer: '0', explanation: 'Вақте ки махраҷ ба беохирӣ майл мекунад, каср ба сифр майл мекунад.' },
    { id: 10, type: 'complex', question: '(2 + 3i) + (4 - i) = ?', options: ['6 + 2i', '6 + 4i', '2 + 2i', '-2 - 4i'], answer: '6 + 2i', explanation: 'Қисмҳои ҳақиқӣ ва мавҳумро алоҳида ҷамъ мекунем: (2+4) + (3-1)i = 6 + 2i.' },
    { id: 11, type: 'stereometry', question: 'Масоҳати секунҷаи гирди меҳвари ОХ тобхӯрда чӣ гуна ҷисми геометрӣ ҳосил мекунад?', options: ['Силиндр', 'Конус', 'Кура', 'Призма'], answer: 'Конус', explanation: 'Ҳангоми тоб хӯрдани секунҷаи росткунҷа дар гирди яке аз катетҳояш конус ҳосил мешавад.' },
    { id: 12, type: 'integrals', question: 'Маънои геометрии интеграли муайяни ∫ₐᵇ f(x) dx чист?', options: ['дарозии камон', 'ҳаҷми ҷисм', 'масоҳати трапетсияи каҷхатта', 'коэффисиенти кунҷӣ'], answer: 'масоҳати трапетсияи каҷхатта', explanation: 'Ин таърифи асосии геометрии интеграли муайян аст.' },
    { id: 13, type: 'derivatives', question: 'Ҳосилаи функсияи мураккаби y = (2x + 1)⁵ -ро ёбед.', options: ['5(2x+1)⁴', '10(2x+1)⁴', '2(2x+1)⁵', '5(2x)⁴'], answer: '10(2x+1)⁴', explanation: 'y\' = 5(2x+1)⁴ * (2x+1)\' = 5(2x+1)⁴ * 2 = 10(2x+1)⁴.' },
    { id: 14, type: 'probability', question: 'Ду зор якҷоя партофта мешавад. Эҳтимолияти он ки суммаи холҳо 7 шавад, чанд аст?', options: ['1/36', '5/36', '1/6', '7/36'], answer: '1/6', explanation: 'Ҳолатҳои мусоид (1,6), (2,5), (3,4), (4,3), (5,2), (6,1) - 6 ҳолат. Ҳамагӣ 36 ҳолат. P = 6/36 = 1/6.' },
    { id: 15, type: 'complex', question: 'Модули адади комплексии z = 3 + 4i -ро ёбед.', options: ['3', '4', '5', '7'], answer: '5', explanation: '|z| = √(a² + b²) = √(3² + 4²) = √(9 + 16) = √25 = 5.' },
    { id: 16, type: 'limits', question: 'lim (x→0) sin(x)/x = ?', options: ['0', '1', '∞', 'π'], answer: '1', explanation: 'Ин лимити якуми аҷоиб аст.' },
    { id: 17, type: 'integrals', question: '∫cos(x) dx = ?', options: ['-sin(x) + C', 'sin(x) + C', 'cos(x) + C', 'tan(x) + C'], answer: 'sin(x) + C', explanation: 'Ҳосилаи sin(x) ба cos(x) баробар аст.' },
    { id: 18, type: 'derivatives', question: 'f(x) = x³ - 3x. Нуқтаҳои критикиро ёбед.', options: ['0', '1', '1 ва -1', '3'], answer: '1 ва -1', explanation: 'f\'(x) = 3x²-3. 3x²-3 = 0 => x²=1 => x=1 ва x=-1.' },
    { id: 19, type: 'stereometry', question: 'Ҳаҷми кураи радиусаш 3 чанд аст?', options: ['9π', '12π', '18π', '36π'], answer: '36π', explanation: 'V = (4/3)πR³ = (4/3)π(3)³ = (4/3) * 27 * π = 36π.' },
    { id: 20, type: 'probability', question: 'Эҳтимолияти он ки аз калимаи "МАТЕМАТИКА" ҳарфи "А" интихоб шавад, чанд аст?', options: ['1/10', '3/10', '4/10', '5/10'], answer: '4/10', explanation: 'Дар калима 10 ҳарф ҳаст, ки 4-тои он "А" мебошад. P = 4/10.' },
  ]
};


// --- Маълумот дар бораи мавзӯъҳо, назария ва саволҳои дохили мавзӯъ ---
const gradeData = {
  '5': {
    name: "Синфи 5",
    topics: {
      natural_numbers: {
        name: "Ададҳои натуральӣ", icon: "1️⃣",
        theory: `Ададҳои натуральӣ ададҳои мусбати бутун (1, 2, 3, ...) мебошанд, ки барои ҳисоб кардани ашёҳо истифода мешаванд. Онҳо асоси математика буда, дар ҳаёти ҳаррӯза барои ҳисоби вақт, пул ва миқдорҳо муҳиманд. Хосиятҳои онҳо, ба монанди ҷамъшавӣ ва тартиб, барои ҳалли масъалаҳои содда кӯмак мерасонанд.`,
        learningQuestions: [
          { type: 'open', question: 'Аввалин адади натуральӣ кадом аст?', answer: '1' },
          { type: 'multiple-choice', question: 'Кадом адад ба ададҳои натуральӣ дохил намешавад?', options: ['0', '1', '2', '3'], answer: '0' }
        ]
      },
      arithmetic_operations: {
        name: "Амалҳои арифметикӣ", icon: "➕",
        theory: `Амалҳои арифметикӣ ҷамъ, тарҳ, зарб ва тақсимро дар бар мегиранд. Ин амалҳо барои ҳалли масъалаҳои ҳаррӯза заруранд. Тартиби иҷрои амалҳо (аввал қавсҳо, баъд зарб/тақсим, сипас ҷамъ/тарҳ) барои натиҷаҳои дуруст муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Натиҷаи 7 × 3 чанд аст?', answer: '21' },
          { type: 'multiple-choice', question: '20 ÷ 4 = ?', options: ['3', '4', '5', '6'], answer: '5' }
        ]
      },
      fractions: {
        name: "Касрҳо", icon: "➗",
        theory: `Каср як қисми бутунро ифода мекунад, ки аз сурат (боло) ва махраҷ (поён) иборат аст. Махраҷ нишон медиҳад, ки бутун ба чанд қисми баробар тақсим шудааст, ва сурат нишон медиҳад, ки чанд қисм гирифта шудааст. Барои ҷамъ ё тарҳ, махраҷи умумӣ лозим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Дар касри 4/7, махраҷ кадом аст?', answer: '7' },
          { type: 'multiple-choice', question: '1/5 ба кадом адади даҳӣ баробар аст?', options: ['0.2', '0.25', '0.3', '0.5'], answer: '0.2' }
        ]
      },
      decimals: {
        name: "Ададҳои даҳӣ", icon: "🔢",
        theory: `Ададҳои даҳӣ касрҳо бо махраҷи дараҷаи 10 (10, 100, ...) мебошанд, ки бо вергул навишта мешаванд. Масалан, 2.3 маънои 2 бутун ва 3/10-ро дорад. Ҳисобҳо бо ададҳои даҳӣ ба ададҳои бутун монанданд, аммо ба вергул диққат лозим аст.`,
        learningQuestions: [
          { type: 'open', question: '3.4-ро ба каср нависед.', answer: '34/10' },
          { type: 'multiple-choice', question: '0.6 + 0.3 = ?', options: ['0.8', '0.9', '1.0', '1.1'], answer: '0.9' }
        ]
      },
      mixed_fractions: {
        name: "Касрҳои омехта", icon: "🧩",
        theory: `Касрҳои омехта қисми бутун ва касриро дар бар мегиранд (масалан, 3 1/4). Онҳо барои ифодаи миқдорҳои ғайрибутун муфиданд ва метавонанд ба касрҳои ғайриҳақиқӣ (масалан, 13/4) табдил ёбанд.`,
        learningQuestions: [
          { type: 'open', question: '2 3/5-ро ба касри ғайриҳақиқӣ табдил диҳед.', answer: '13/5' },
          { type: 'multiple-choice', question: '4 1/3 = ?', options: ['12/3', '13/3', '14/3', '15/3'], answer: '13/3' }
        ]
      },
      comparing_fractions: {
        name: "Муқоисаи касрҳо", icon: "⚖️",
        theory: `Барои муқоисаи касрҳо, агар махраҷҳо якхела бошанд, сурати калонтар касри калонтарро медиҳад. Агар махраҷҳо гуногун бошанд, касрҳоро ба махраҷи умумӣ овардан ё ба даҳӣ табдил додан лозим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Кадом калонтар аст: 2/5 ё 3/7?', answer: '3/7' },
          { type: 'multiple-choice', question: '1/3 ва 2/5: кадоме калонтар аст?', options: ['1/3', '2/5', 'баробар', 'ҳеҷ яке'], answer: '2/5' }
        ]
      },
      divisibility: {
        name: "Тақсимпазирӣ", icon: "🔄",
        theory: `Тақсимпазирӣ муайян мекунад, ки оё як адад ба адади дигар тақсим мешавад, бидуни боқимонда. Масалан, 20 ба 4 тақсимпазир аст, чунки 20 ÷ 4 = 5. Қоидаҳои тақсимпазирӣ (ба 2, 3, 5) ҳисобҳоро осон мекунанд.`,
        learningQuestions: [
          { type: 'open', question: 'Оё 24 ба 6 тақсимпазир аст?', answer: 'Ҳа' },
          { type: 'multiple-choice', question: 'Кадом адад ба 3 тақсимпазир аст?', options: ['14', '15', '16', '17'], answer: '15' }
        ]
      },
      factors_and_multiples: {
        name: "Омилҳо ва кратҳо", icon: "🔢",
        theory: `Омилҳо ададҳоеанд, ки ба адади додашуда тақсим мешаванд (масалан, омилҳои 15: 1, 3, 5, 15). Кратҳо натиҷаи зарби адад ба ададҳои бутунанд (масалан, кратҳои 5: 5, 10, 15, ...). Ин мафҳумҳо барои содда кардани касрҳо муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Омилҳои 12-ро номбар кунед.', answer: '1, 2, 3, 4, 6, 12' },
          { type: 'multiple-choice', question: 'Кадоме кратҳои 6 аст?', options: ['10', '12', '14', '16'], answer: '12' }
        ]
      },
      gcd_lcm: {
        name: "БКМ ва КУК", icon: "🔗",
        theory: `Бузургтарин Коиси Муштарак (БКМ) калонтарин ададест, ки ду ададро тақсим мекунад. Хурдтарин Кратти Умумӣ (КУК) хурдтарин ададест, ки ду адад ба он тақсим мешаванд. БКМ барои содда кардани касрҳо ва КУК барои ҷамъи касрҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'БКМ-и 8 ва 12 чанд аст?', answer: '4' },
          { type: 'multiple-choice', question: 'КУК-и 6 ва 9 чанд аст?', options: ['12', '18', '24', '36'], answer: '18' }
        ]
      },
      geometry_basics: {
        name: "Асосҳои геометрия", icon: "📏",
        theory: `Геометрия ба омӯзиши шаклҳо ва хосиятҳои онҳо мепардозад. Дар синфи 5, хонандагон бо нуқта, хат, кунҷ ва шаклҳои оддӣ (секунҷа, чоркунҷа, муррабаъ) шинос мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Чоркунҷа чанд тараф дорад?', answer: '4' },
          { type: 'multiple-choice', question: 'Кадом шакл 3 тараф дорад?', options: ['Муррабаъ', 'Секунҷа', 'Трапеция', 'Доира'], answer: 'Секунҷа' }
        ]
      },
      perimeter: {
        name: "Периметр", icon: "📏",
        theory: `Периметр суммаи дарозии тарафҳои шакли геометрӣ аст. Барои муррабаъ, P = 4a, барои чоркунҷа, P = 2(a + b). Ин мафҳум дар масъалаҳои амалӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Периметри муррабаъ бо тарафи 7 см чанд аст?', answer: '28 см' },
          { type: 'multiple-choice', question: 'Периметри чоркунҷа бо тарафҳои 4 ва 6 чанд аст?', options: ['18', '20', '22', '24'], answer: '20' }
        ]
      },
      area_basics: {
        name: "Масоҳати шаклҳо", icon: "📐",
        theory: `Масоҳат миқдори рӯизаминро, ки шакли геометрӣ фаро мегирад, ифода мекунад. Барои муррабаъ, A = a², барои чоркунҷа, A = a × b. Ин дар ҳисобҳои амалӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Масоҳати муррабаъ бо тарафи 5 см чанд аст?', answer: '25 см²' },
          { type: 'multiple-choice', question: 'Масоҳати чоркунҷа бо тарафҳои 3 ва 4 чанд аст?', options: ['10', '12', '14', '16'], answer: '12' }
        ]
      },
      angles: {
        name: "Кунҷҳо", icon: "∠",
        theory: `Кунҷ ченаки гардиши байни ду хат аст, ки дар дараҷаҳо чен карда мешавад. Кунҷи рост 90°, тез <90°, кунд >90°. Фаҳмидани кунҷҳо барои геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Кунҷи тез чанд дараҷа аст?', answer: 'Камтар аз 90' },
          { type: 'multiple-choice', question: 'Кунҷи 150° чӣ ном дорад?', options: ['Тез', 'Рост', 'Кунд', 'Пурра'], answer: 'Кунд' }
        ]
      },
      time_measurement: {
        name: "Ченкунии вақт", icon: "⏰",
        theory: `Вақт дар соат, дақиқа ва сония чен карда мешавад. 1 соат = 60 дақиқа, 1 дақиқа = 60 сония. Ин барои ҳалли масъалаҳои марбут ба вақт муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: '2 соат чанд дақиқа аст?', answer: '120' },
          { type: 'multiple-choice', question: '30 дақиқа чанд сония аст?', options: ['1800', '1200', '1500', '2000'], answer: '1800' }
        ]
      },
      length_measurement: {
        name: "Ченкунии дарозӣ", icon: "📏",
        theory: `Дарозӣ дар метр, сантиметр ва миллиметр чен карда мешавад. 1 метр = 100 сантиметр, 1 сантиметр = 10 миллиметр. Ин воҳидҳо дар ҳаёти ҳаррӯза муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: '3 метр чанд сантиметр аст?', answer: '300' },
          { type: 'multiple-choice', question: '40 см чанд мм аст?', options: ['400', '40', '4', '4000'], answer: '400' }
        ]
      },
      mass_measurement: {
        name: "Ченкунии масса", icon: "⚖️",
        theory: `Масса дар килограмм ва грамм чен карда мешавад. 1 килограмм = 1000 грамм. Ин мафҳум дар хариди маҳсулот ва ҳисобҳои дигар муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: '4 кг чанд грамм аст?', answer: '4000' },
          { type: 'multiple-choice', question: '250 г чанд кг аст?', options: ['0.25', '2.5', '25', '0.025'], answer: '0.25' }
        ]
      },
      volume_measurement: {
        name: "Ченкунии ҳаҷм", icon: "🧊",
        theory: `Ҳаҷм миқдори фазои сеандозаест, ки дар литр ва миллилитр чен карда мешавад. 1 литр = 1000 миллилитр. Ин барои ҳисобҳои моеъҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: '3 литр чанд миллилитр аст?', answer: '3000' },
          { type: 'multiple-choice', question: '500 мл чанд литр аст?', options: ['0.5', '5', '50', '0.05'], answer: '0.5' }
        ]
      },
      word_problems: {
        name: "Масъалаҳои матнӣ", icon: "📝",
        theory: `Масъалаҳои матнӣ дар шакли ҳикоя пешниҳод шуда, амалҳои арифметикиро талаб мекунанд. Онҳо ба хонандагон кӯмак мекунанд, ки математикаро дар ҳаёти воқеӣ татбиқ кунанд.`,
        learningQuestions: [
          { type: 'open', question: 'Агар 2 китоб 10 сомонӣ бошад, 3 китоб чанд сомонӣ аст?', answer: '15' },
          { type: 'multiple-choice', question: 'Агар 4 кг себ 20 сомонӣ бошад, 2 кг чанд сомонӣ аст?', options: ['8', '10', '12', '14'], answer: '10' }
        ]
      },
      patterns: {
        name: "Қонунмандиҳо", icon: "🔢",
        theory: `Қонунмандиҳо нақш ё тартиби муайяни ададҳоро ифода мекунанд. Масалан, силсилаи 3, 6, 9, ... арифметикӣ бо фарқияти 3 аст. Онҳо барои пешгӯии ададҳои навбатӣ муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Адади навбатии силсилаи 4, 8, 12, ... кадом аст?', answer: '16' },
          { type: 'multiple-choice', question: 'Дар силсилаи 2, 4, 8, ... адади навбатӣ кадом аст?', options: ['12', '16', '10', '14'], answer: '16' }
        ]
      },
      symmetry: {
        name: "Симметрия", icon: "🔄",
        theory: `Симметрия вақтест, ки як қисми шакл ба қисми дигараш мувофиқат мекунад, агар онро гардонем ё инъикос кунем. Муррабаъ симметрияи чоркарата дорад. Ин дар геометрия ва санъат муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Кадом шакл симметрияи даврӣ дорад?', answer: 'Доира' },
          { type: 'multiple-choice', question: 'Секунҷаи баробарҷониба чанд меҳвари симметрия дорад?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      }
    }
  },
  '6': {
    name: "Синфи 6",
    topics: {
      percentages: {
        name: "Фоизҳо", icon: "%",
        theory: `Фоиз садяки қисми ягон миқдор аст, бо аломати % ишора мешавад. Барои ёфтани фоиз: (Адад × Фоиз) / 100. Фоизҳо дар тахфифҳо, фоизҳои бонкӣ ва омор истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: '30%-и 50 чанд аст?', answer: '15' },
          { type: 'multiple-choice', question: '20% аз 150 чанд аст?', options: ['20', '30', '40', '50'], answer: '30' }
        ]
      },
      ratios: {
        name: "Нисбат ва Таносуб", icon: "⚖️",
        theory: `Нисбат муқоисаи ду миқдор аст (масалан, 3:4). Таносуб баробарии ду нисбат аст (a/b = c/d). Хосияти асосӣ: a × d = b × c. Ин дар ҳалли масъалаҳои амалӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Нисбати 8 ба 12-ро содда кунед.', answer: '2:3' },
          { type: 'multiple-choice', question: 'Дар таносуби x/6 = 4/8, x чанд аст?', options: ['2', '3', '4', '5'], answer: '3' }
        ]
      },
      integers: {
        name: "Ададҳои бутун", icon: "🔢",
        theory: `Ададҳои бутун мусбат, манфӣ ва сифрро дар бар мегиранд (...-2, -1, 0, 1, 2...). Онҳо барои ифодаи миқдорҳои манфӣ (масалан, ҳарорат) ва ҳисобҳои мураккаб муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Натиҷаи (-5) + 7 чанд аст?', answer: '2' },
          { type: 'multiple-choice', question: '(-3) × (-4) = ?', options: ['-12', '12', '9', '-9'], answer: '12' }
        ]
      },
      negative_numbers: {
        name: "Ададҳои манфӣ", icon: "➖",
        theory: `Ададҳои манфӣ ададҳоеанд, ки аз сифр хурдтаранд (-1, -2, ...). Онҳо дар ҳисобҳои марбут ба қарз, ҳарорат ва координатаҳо истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: '(-2) + (-3) чанд аст?', answer: '-5' },
          { type: 'multiple-choice', question: '(-6) - (-2) = ?', options: ['-4', '-8', '4', '8'], answer: '-4' }
        ]
      },
      fraction_operations: {
        name: "Амалҳо бо касрҳо", icon: "➗",
        theory: `Амалҳо бо касрҳо ҷамъ, тарҳ, зарб ва тақсимро дар бар мегиранд. Барои ҷамъ/тарҳ, махраҷи умумӣ лозим аст. Барои зарб, суратҳоро ва махраҷҳоро зарб мекунем. Барои тақсим, касри дуюмро баръакс карда, зарб мекунем.`,
        learningQuestions: [
          { type: 'open', question: '1/3 × 3/5 чанд аст?', answer: '1/5' },
          { type: 'multiple-choice', question: '2/3 + 1/6 = ?', options: ['1/2', '5/6', '3/6', '4/6'], answer: '5/6' }
        ]
      },
      decimal_operations: {
        name: "Амалҳо бо ададҳои даҳӣ", icon: "🔢",
        theory: `Амалҳо бо ададҳои даҳӣ ба ададҳои бутун монанданд, аммо ба вергул диққат лозим аст. Барои ҷамъ/тарҳ, вергулҳоро мутобиқ мекунем, барои зарб, вергулҳоро пас аз ҳисоб муайян мекунем.`,
        learningQuestions: [
          { type: 'open', question: '2.5 × 0.4 чанд аст?', answer: '1.0' },
          { type: 'multiple-choice', question: '1.2 + 0.8 = ?', options: ['1.8', '2.0', '2.2', '2.4'], answer: '2.0' }
        ]
      },
      simple_equations: {
        name: "Муодилаҳои содда", icon: "🔣",
        theory: `Муодилаи содда баробариест, ки тағйирёбанда (масалан, x) дорад. Барои ҳал, амалҳои баръаксро (тарҳ барои ҷамъ, тақсим барои зарб) истифода мебарем.`,
        learningQuestions: [
          { type: 'open', question: 'Дар муодилаи x + 4 = 10, x чанд аст?', answer: '6' },
          { type: 'multiple-choice', question: '2x = 8, x = ?', options: ['2', '3', '4', '5'], answer: '4' }
        ]
      },
      triangle_area: {
        name: "Масоҳати секунҷа", icon: "📐",
        theory: `Масоҳати секунҷа бо формулаи A = (a × h) / 2 ҳисоб мешавад, ки a поя ва h баландӣ аст. Ин барои ҳисобҳои геометрӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Масоҳати секунҷа бо пояи 6 см ва баландии 4 см чанд аст?', answer: '12 см²' },
          { type: 'multiple-choice', question: 'Масоҳати секунҷа бо пояи 8 ва баландии 3 чанд аст?', options: ['12', '18', '24', '30'], answer: '12' }
        ]
      },
      speed_distance_time: {
        name: "Суръат, масофа, вақт", icon: "🚗",
        theory: `Суръат, масофа ва вақт бо формулаи S = D / T вобастаанд. Барои ёфтани масофа, D = S × T, барои вақт, T = D / S. Ин дар масъалаҳои амалӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Агар суръат 60 км/соат ва вақт 2 соат бошад, масофа чанд аст?', answer: '120 км' },
          { type: 'multiple-choice', question: 'Масофа 100 км, суръат 50 км/соат, вақт чанд аст?', options: ['1', '2', '3', '4'], answer: '2' }
        ]
      },
      coordinate_plane: {
        name: "Ҳамоҳангсоз", icon: "📍",
        theory: `Ҳамоҳангсоз системаест, ки нуқтаҳоро бо координатаҳо (x, y) ифода мекунад. Меҳвари x уфуқӣ ва y амудӣ аст. Ин барои геометрия ва графикҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Координатаи нуқта дар маркази ҳамоҳангсоз кадом аст?', answer: '(0,0)' },
          { type: 'multiple-choice', question: 'Нуқтаи (2,3) дар кадом чоряк аст?', options: ['I', 'II', 'III', 'IV'], answer: 'I' }
        ]
      },
      parallel_lines: {
        name: "Хатҳои параллел", icon: "📏",
        theory: `Хатҳои параллел хатҳоеанд, ки ҳеҷ гоҳ якдигарро бурида наметавонанд ва кунҷи байни онҳо 0° аст. Ин дар геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Хатҳои параллел чӣ хусусият доранд?', answer: 'Ҳеҷ гоҳ якдигарро намебуранд' },
          { type: 'multiple-choice', question: 'Кунҷи байни хатҳои параллел чанд аст?', options: ['0°', '90°', '180°', '360°'], answer: '0°' }
        ]
      },
      perpendicular_lines: {
        name: "Хатҳои перпендикуляр", icon: "⊥",
        theory: `Хатҳои перпендикуляр бо кунҷи 90° якдигарро мебуранд. Ин дар сохтмон ва геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Кунҷи байни хатҳои перпендикуляр чанд аст?', answer: '90°' },
          { type: 'multiple-choice', question: 'Оё хатҳои перпендикуляр метавонанд параллел бошанд?', options: ['Ҳа', 'Не', 'Баъзан', 'Ҳамеша'], answer: 'Не' }
        ]
      },
      polygons: {
        name: "Кногонаҳо", icon: "🔶",
        theory: `Кногона шакли пӯшидаест, ки бо хатҳои рост сохта шудааст. Масалан, секунҷа (3 тараф), чоркунҷа (4 тараф). Ин барои омӯзиши геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Панҷгона чанд тараф дорад?', answer: '5' },
          { type: 'multiple-choice', question: 'Кадоме кногона аст?', options: ['Доира', 'Секунҷа', 'Хати рост', 'Нуқта'], answer: 'Секунҷа' }
        ]
      },
      circle_basics: {
        name: "Асосҳои доира", icon: "⭕",
        theory: `Доира шаклест, ки ҳамаи нуқтаҳояш аз марказ ба масофаи баробар (радиус) ҷойгиранд. Диаметр ду радиус аст. Ин дар геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Диаметр чанд маротиба аз радиус калонтар аст?', answer: '2' },
          { type: 'multiple-choice', question: 'Агар радиус 3 бошад, диаметр чанд аст?', options: ['3', '6', '9', '12'], answer: '6' }
        ]
      },
      data_representation: {
        name: "Намоиши додаҳо", icon: "📊",
        theory: `Додаҳо бо диаграммаҳои сутунӣ, доирагӣ ё хаттӣ намоиш дода мешаванд. Ин барои таҳлили маълумот муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Диаграммаи сутунӣ барои чӣ истифода мешавад?', answer: 'Намоиши муқоисавии додаҳо' },
          { type: 'multiple-choice', question: 'Кадом диаграмма додаҳоро бо доира нишон медиҳад?', options: ['Сутунӣ', 'Доирагӣ', 'Хаттӣ', 'Ҳама'], answer: 'Доирагӣ' }
        ]
      },
      mean_median: {
        name: "Миёна ва медиана", icon: "📈",
        theory: `Миёна (арифметикӣ) суммаи додаҳо ба шумораи онҳо тақсим мешавад. Медиана адади миёна дар силсилаи тартибшуда аст.`,
        learningQuestions: [
          { type: 'open', question: 'Миёнаи 2, 4, 6 чанд аст?', answer: '4' },
          { type: 'multiple-choice', question: 'Медианаи 1, 3, 5, 7 чанд аст?', options: ['3', '4', '5', '6'], answer: '4' }
        ]
      },
      probability_basics: {
        name: "Асосҳои эҳтимолият", icon: "🎲",
        theory: `Эҳтимолият имкони рух додани як ҳодисаро нишон медиҳад, аз 0 (номумкин) то 1 (аниқ). Масалан, эҳтимолияти баромадани рақами 6 дар зар як шашум аст.`,
        learningQuestions: [
          { type: 'open', question: 'Эҳтимолияти баромадани рақами 1 дар зар чанд аст?', answer: '1/6' },
          { type: 'multiple-choice', question: 'Эҳтимолияти баромадани сари танга чанд аст?', options: ['1/2', '1/3', '1/4', '1'], answer: '1/2' }
        ]
      },
      order_of_operations: {
        name: "Тартиби амалҳо", icon: "🔢",
        theory: `Тартиби амалҳо (PEMDAS): аввал қавсҳо, баъд дараҷаҳо, сипас зарб/тақсим, ва ниҳоят ҷамъ/тарҳ. Ин барои натиҷаҳои дуруст муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Натиҷаи 2 + 3 × 4 чанд аст?', answer: '14' },
          { type: 'multiple-choice', question: '(5 + 3) × 2 = ?', options: ['16', '11', '10', '13'], answer: '16' }
        ]
      },
      prime_numbers: {
        name: "Ададҳои аввал", icon: "🔢",
        theory: `Ададҳои аввал фақат ба 1 ва худи худ тақсим мешаванд (масалан, 2, 3, 5, 7). Онҳо дар тақсимпазирӣ ва омилкунӣ муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Аввалин адади аввал кадом аст?', answer: '2' },
          { type: 'multiple-choice', question: 'Кадоме адади аввал аст?', options: ['4', '6', '7', '9'], answer: '7' }
        ]
      },
      exponents_basics: {
        name: "Асосҳои дараҷа", icon: "🔢",
        theory: `Дараҷа нишон медиҳад, ки адад чанд маротиба ба худ зарб мешавад (масалан, 2³ = 2 × 2 × 2 = 8). Ин дар ҳисобҳои мураккаб муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: '2⁴ чанд аст?', answer: '16' },
          { type: 'multiple-choice', question: '3² = ?', options: ['6', '9', '12', '15'], answer: '9' }
        ]
      }
    }
  },
  '7': {
    name: "Синфи 7",
    topics: {
      algebra_basics: {
        name: "Асосҳои алгебра", icon: "🔣",
        theory: `Алгебра бо тағйирёбандаҳо (x, y) кор мекунад. Ифодаҳои алгебравӣ аз ададҳо, тағйирёбандаҳо ва амалҳо иборатанд. Муодилаҳо барои ёфтани тағйирёбанда истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Дар муодилаи 3x + 2 = 11, x чанд аст?', answer: '3' },
          { type: 'multiple-choice', question: '4y - 8 = 12, y = ?', options: ['3', '4', '5', '6'], answer: '5' }
        ]
      },
      linear_equations: {
        name: "Муодилаҳои хаттӣ", icon: "📈",
        theory: `Муодилаи хаттӣ шакли ax + b = c дорад. Барои ҳал, тағйирёбандаро ҷудо мекунем, бо истифода аз амалҳои баръакс (тарҳ, тақсим).`,
        learningQuestions: [
          { type: 'open', question: '5x - 10 = 15, x чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: '2x + 3 = 9, x = ?', options: ['2', '3', '4', '5'], answer: '3' }
        ]
      },
      inequalities: {
        name: "Нобаробариҳо", icon: "≠",
        theory: `Нобаробариҳо муносибати нобаробариро (>, <, ≥, ≤) нишон медиҳанд. Ҳал монанд ба муодилаҳост, аммо аломати нобаробарӣ нигоҳ дошта мешавад.`,
        learningQuestions: [
          { type: 'open', question: 'Дар нобаробарии x + 3 > 7, x чанд аст?', answer: 'x > 4' },
          { type: 'multiple-choice', question: '3x < 12, x = ?', options: ['x < 3', 'x < 4', 'x < 5', 'x < 6'], answer: 'x < 4' }
        ]
      },
      polynomials: {
        name: "Полиномҳо", icon: "🔢",
        theory: `Полином ифодаи алгебравӣ бо як ё якчанд тағйирёбанда ва дараҷаҳост (масалан, 3x² + 2x + 1). Онҳо дар алгебра муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Дараҷаи полиноми 2x³ + x чанд аст?', answer: '3' },
          { type: 'multiple-choice', question: 'Полиноми x² + 3x + 2 чанд ҳад дорад?', options: ['1', '2', '3', '4'], answer: '2' }
        ]
      },
      factoring: {
        name: "Омилкунӣ", icon: "🔢",
        theory: `Омилкунӣ полиномро ба омилҳо тақсим мекунад (масалан, x² + 5x + 6 = (x + 2)(x + 3)). Ин барои ҳалли муодилаҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'x² + 4x + 4-ро омил кунед.', answer: '(x + 2)(x + 2)' },
          { type: 'multiple-choice', question: 'x² + 3x + 2 = ?', options: ['(x + 1)(x + 2)', '(x + 2)(x + 3)', '(x + 1)(x + 3)', '(x + 2)(x + 4)'], answer: '(x + 1)(x + 2)' }
        ]
      },
      linear_graphs: {
        name: "Графикҳои хаттӣ", icon: "📉",
        theory: `Графики муодилаи хаттӣ (y = mx + c) хати рост аст, ки m шиб ва c нуқтаи буриши меҳвари y аст. Ин барои таҳлили муносибатҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Шиби муодилаи y = 2x + 3 чанд аст?', answer: '2' },
          { type: 'multiple-choice', question: 'Нуқтаи буриши y = 3x + 4 бо меҳвари y кадом аст?', options: ['(0,3)', '(0,4)', '(3,0)', '(4,0)'], answer: '(0,4)' }
        ]
      },
      proportions: {
        name: "Таносубҳо", icon: "⚖️",
        theory: `Таносуб баробарии ду нисбат аст (a/b = c/d). Хосияти асосӣ: a × d = b × c. Ин дар ҳалли масъалаҳои амалӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Дар таносуби 3/x = 6/8, x чанд аст?', answer: '4' },
          { type: 'multiple-choice', question: '5/10 = x/20, x = ?', options: ['5', '10', '15', '20'], answer: '10' }
        ]
      },
      triangle_properties: {
        name: "Хосиятҳои секунҷа", icon: "📐",
        theory: `Секунҷа се тараф ва се кунҷ дорад, ки суммаи кунҷҳояш 180° аст. Намудҳо: баробарҷониба, баробарсохт, росткунҷа.`,
        learningQuestions: [
          { type: 'open', question: 'Суммаи кунҷҳои секунҷа чанд дараҷа аст?', answer: '180' },
          { type: 'multiple-choice', question: 'Секунҷаи баробарҷониба чанд кунҷи баробар дорад?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      },
      angle_pairs: {
        name: "Ҷуфтҳои кунҷҳо", icon: "∠",
        theory: `Ҷуфтҳои кунҷҳо иборатанд аз кунҷҳои мутақобил (баробар) ва мутамом (суммаашон 180°). Ин дар геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Кунҷи мутамоми 40° чанд аст?', answer: '140°' },
          { type: 'multiple-choice', question: 'Кунҷи мутақобили 60° чанд аст?', options: ['30°', '60°', '90°', '120°'], answer: '60°' }
        ]
      },
      circle_area: {
        name: "Масоҳати доира", icon: "⭕",
        theory: `Масоҳати доира бо формулаи A = πr² ҳисоб мешавад, ки r радиус аст. Ин дар ҳисобҳои геометрӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Масоҳати доира бо радиуси 2 (π = 3.14) чанд аст?', answer: '12.56' },
          { type: 'multiple-choice', question: 'Масоҳати доира бо радиуси 3 (π = 3) чанд аст?', options: ['18', '27', '36', '45'], answer: '27' }
        ]
      },
      circle_circumference: {
        name: "Дарозии доира", icon: "⭕",
        theory: `Дарозии доира бо формулаи C = 2πr ё C = πd ҳисоб мешавад, ки r радиус ва d диаметр аст.`,
        learningQuestions: [
          { type: 'open', question: 'Дарозии доира бо радиуси 5 (π = 3.14) чанд аст?', answer: '31.4' },
          { type: 'multiple-choice', question: 'Дарозии доира бо диаметри 4 (π = 3) чанд аст?', options: ['12', '14', '16', '18'], answer: '12' }
        ]
      },
      volume_prism: {
        name: "Ҳаҷми призма", icon: "🧊",
        theory: `Ҳаҷми призма бо формулаи V = A × h ҳисоб мешавад, ки A масоҳати поя ва h баландӣ аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳаҷми призма бо пояи 10 см² ва баландии 5 см чанд аст?', answer: '50 см³' },
          { type: 'multiple-choice', question: 'Ҳајми призма бо пояи 6 ва баландии 4 чанд аст?', options: ['24', '30', '36', '42'], answer: '24' }
        ]
      },
      surface_area: {
        name: "Масоҳати рӯизамин", icon: "📏",
        theory: `Масоҳати рӯизамини призма суммаи масоҳати ҳамаи рӯйҳост. Барои куб, A = 6a². Ин дар геометрия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Масоҳати рӯизамини куб бо тарафи 3 см чанд аст?', answer: '54 см²' },
          { type: 'multiple-choice', question: 'Масоҳати рӯизамини куб бо тарафи 4 чанд аст?', options: ['64', '96', '128', '144'], answer: '96' }
        ]
      },
      similarity: {
        name: "Монандӣ", icon: "🔍",
        theory: `Шаклҳои монанд кунҷҳои баробар ва тарафҳои таносуб доранд. Ин дар геометрия барои муқоисаи шаклҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Агар ду секунҷа кунҷҳои баробар дошта бошанд, онҳо чӣ ном доранд?', answer: 'Монанд' },
          { type: 'multiple-choice', question: 'Агар тарафҳои секунҷаи монанд ба 2:3 бошанд, таносуб чанд аст?', options: ['2:3', '3:2', '1:2', '2:1'], answer: '2:3' }
        ]
      },
      exponents: {
        name: "Дараҷаҳо", icon: "🔢",
        theory: `Дараҷа нишон медиҳад, ки адад чанд маротиба ба худ зарб мешавад (масалан, 4³ = 64). Хосиятҳо: a^m × a^n = a^(m+n).`,
        learningQuestions: [
          { type: 'open', question: '3³ чанд аст?', answer: '27' },
          { type: 'multiple-choice', question: '2⁴ × 2² = ?', options: ['2⁴', '2⁶', '2⁸', '2¹⁰'], answer: '2⁶' }
        ]
      },
      scientific_notation: {
        name: "Навишти илмӣ", icon: "🔢",
        theory: `Навишти илмӣ ададҳоро дар шакли a × 10^n ифода мекунад, ки 1 ≤ a < 10. Ин барои ададҳои хеле калон ё хурд муфид аст.`,
        learningQuestions: [
          { type: 'open', question: '10000-ро дар навишти илмӣ нависед.', answer: '1 × 10⁴' },
          { type: 'multiple-choice', question: '0.003 дар навишти илмӣ чанд аст?', options: ['3 × 10⁻³', '3 × 10⁻²', '3 × 10⁻¹', '3 × 10⁰'], answer: '3 × 10⁻³' }
        ]
      },
      probability: {
        name: "Эҳтимолият", icon: "🎲",
        theory: `Эҳтимолият имкони рух додани ҳодисаро аз 0 то 1 нишон медиҳад. Барои ҳодисаи A, P(A) = (ҳолатҳои мусоид) / (ҳамаи ҳолатҳо).`,
        learningQuestions: [
          { type: 'open', question: 'Эҳтимолияти баромадани рақами зуҷ дар зар чанд аст?', answer: '1/2' },
          { type: 'multiple-choice', question: 'Эҳтимолияти баромадани сари танга чанд аст?', options: ['1/3', '1/2', '1/4', '1'], answer: '1/2' }
        ]
      },
      data_analysis: {
        name: "Таҳлили додаҳо", icon: "📊",
        theory: `Таҳлили додаҳо омӯзиши маълумот бо истифода аз миёна, медиана, мода ва диаграммаҳост. Ин барои омор муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Модаи силсилаи 1, 2, 2, 3, 4 чанд аст?', answer: '2' },
          { type: 'multiple-choice', question: 'Миёнаи 2, 4, 6, 8 чанд аст?', options: ['4', '5', '6', '7'], answer: '5' }
        ]
      },
      transformations: {
        name: "Табдилҳо", icon: "🔄",
        theory: `Табдилҳо иборатанд аз инъикос, гардиш ва интиқол. Онҳо шаклҳоро дар ҳамоҳангсоз тағйир медиҳанд, аммо хосиятҳои геометриро нигоҳ медоранд.`,
        learningQuestions: [
          { type: 'open', question: 'Инъикос чист?', answer: 'Оина кардани шакл нисбат ба меҳвар' },
          { type: 'multiple-choice', question: 'Гардиши 90° секунҷаро чӣ тағйир медиҳад?', options: ['Масоҳат', 'Кунҷҳо', 'Ҷойгиршавӣ', 'Тарафҳо'], answer: 'Ҷойгиршавӣ' }
        ]
      },
      congruence: {
        name: "Мутобиқат", icon: "🔍",
        theory: `Шаклҳои мутобиқ кунҷҳо ва тарафҳои баробар доранд. Ин дар исботи хосиятҳои геометрӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Секунҷаҳои мутобиқ чӣ хусусият доранд?', answer: 'Тарафҳо ва кунҷҳои баробар' },
          { type: 'multiple-choice', question: 'Оё ду секунҷа бо кунҷҳои баробар мутобиқанд?', options: ['Ҳа', 'Не', 'Баъзан', 'Ҳамеша'], answer: 'Баъзан' }
        ]
      }
    }
  },
  '8': {
    name: "Синфи 8",
    topics: {
      pythagoras: {
        name: "Теоремаи Пифагор", icon: "📐",
        theory: `Дар секунҷаи росткунҷа, a² + b² = c², ки a ва b катетҳо, c гипотенуза аст. Ин барои ёфтани дарозии тарафҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Агар катетҳо 3 ва 4 бошанд, гипотенуза чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: 'Катетҳо 6 ва 8, гипотенуза чанд аст?', options: ['10', '12', '14', '16'], answer: '10' }
        ]
      },
      systems_of_equations: {
        name: "Системаи муодилаҳо", icon: "🔣",
        theory: `Системаи муодилаҳо якчанд муодилаест, ки якҷоя ҳал мешаванд. Усулҳо: ивазкунӣ, бартарафсозӣ. Ин барои масъалаҳои мураккаб муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Дар системаи x + y = 5 ва x - y = 1, x чанд аст?', answer: '3' },
          { type: 'multiple-choice', question: '2x + y = 8, x + y = 5, y = ?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      },
      functions_basics: {
        name: "Асосҳои функсия", icon: "📈",
        theory: `Функсия муносибати байни тағйирёбандаҳост, ки ба ҳар x як y мувофиқ аст (y = f(x)). Масалан, y = 2x + 1 функсияи хаттӣ аст.`,
        learningQuestions: [
          { type: 'open', question: 'Агар y = 3x + 2 ва x = 1, y чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: 'y = 2x - 1, агар x = 2, y = ?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      },
      quadratic_functions: {
        name: "Функсияҳои квадратӣ", icon: "📈",
        theory: `Функсияи квадратӣ шакли y = ax² + bx + c дорад. Графикаш парабола аст. Решаҳо бо муодилаи ax² + bx + c = 0 ёфта мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Решаи y = x² - 4 чанд аст?', answer: 'x = ±2' },
          { type: 'multiple-choice', question: 'Вершини y = x² чанд аст?', options: ['(0,0)', '(1,1)', '(0,1)', '(1,0)'], answer: '(0,0)' }
        ]
      },
      exponent_rules: {
        name: "Қоидаҳои дараҷа", icon: "🔢",
        theory: `Қоидаҳои дараҷа: a^m × a^n = a^(m+n), a^m / a^n = a^(m-n), (a^m)^n = a^(m×n). Ин барои содда кардани ифодаҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: '2³ × 2⁴ чанд аст?', answer: '2⁷' },
          { type: 'multiple-choice', question: '(3²)³ = ?', options: ['3⁵', '3⁶', '3⁷', '3⁸'], answer: '3⁶' }
        ]
      },
      scientific_notation_advanced: {
        name: "Навишти илмии пешрафта", icon: "🔢",
        theory: `Навишти илмӣ барои ададҳои калон ва хурд истифода мешавад (a × 10^n). Амалҳо бо онҳо ба тақсим ва зарби a ва дараҷаҳо вобаста аст.`,
        learningQuestions: [
          { type: 'open', question: '(2 × 10³) × (3 × 10²) чанд аст?', answer: '6 × 10⁵' },
          { type: 'multiple-choice', question: '4 × 10⁴ ÷ 2 × 10² = ?', options: ['2 × 10²', '2 × 10⁴', '2 × 10⁶', '2 × 10⁸'], answer: '2 × 10²' }
        ]
      },
      irrational_numbers: {
        name: "Ададҳои ғайриратсионалӣ", icon: "🔢",
        theory: `Ададҳои ғайриратсионалӣ ба каср навишта намешаванд (масалан, √2, π). Онҳо дар геометрия ва ҳисобҳои дақиқ муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Кадом адад ғайриратсионалӣ аст?', answer: '√2' },
          { type: 'multiple-choice', question: 'Кадоме ғайриратсионалӣ аст?', options: ['1/2', '√3', '0.5', '2'], answer: '√3' }
        ]
      },
      trigonometry_basics: {
        name: "Асосҳои тригонометрия", icon: "📐",
        theory: `Тригонометрия муносибати кунҷҳо ва тарафҳои секунҷаро меомӯзад. Функсияҳои асосӣ: синус (sin), косинус (cos), тангенс (tan).`,
        learningQuestions: [
          { type: 'open', question: 'Синус чист?', answer: 'Нисбати катети муқобил ба гипотенуза' },
          { type: 'multiple-choice', question: 'sin(90°) чанд аст?', options: ['0', '1', '1/2', '√2/2'], answer: '1' }
        ]
      },
      triangle_congruence: {
        name: "Мутобиқати секунҷаҳо", icon: "📐",
        theory: `Секунҷаҳо бо SSS, SAS, ASA мутобиқанд, агар тарафҳо ва кунҷҳояшон баробар бошанд. Ин дар исботҳои геометрӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'SSS чист?', answer: 'Се тарафи баробар' },
          { type: 'multiple-choice', question: 'Кадом меъёр мутобиқатиро нишон медиҳад?', options: ['AAA', 'SAS', 'SAA', 'ASS'], answer: 'SAS' }
        ]
      },
      similarity_advanced: {
        name: "Монандии пешрафта", icon: "🔍",
        theory: `Секунҷаҳои монанд кунҷҳои баробар ва тарафҳои таносуб доранд. Ин барои ҳисобҳои мураккаби геометрӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Агар таносуби секунҷаҳои монанд 2:3 бошад, таносуби масоҳатҳо чанд аст?', answer: '4:9' },
          { type: 'multiple-choice', question: 'Таносуби периметрҳои секунҷаҳои монанд 1:2 аст, таносуби масоҳатҳо чанд аст?', options: ['1:2', '1:4', '2:4', '4:1'], answer: '1:4' }
        ]
      },
      volume_cylinder: {
        name: "Ҳаҷми силиндр", icon: "🧊",
        theory: `Ҳаҷми силиндр бо формулаи V = πr²h ҳисоб мешавад, ки r радиус ва h баландӣ аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳаҷми силиндр бо радиуси 2 ва баландии 5 (π = 3.14) чанд аст?', answer: '62.8' },
          { type: 'multiple-choice', question: 'Ҳајми силиндр бо радиуси 3 ва баландии 4 (π = 3) чанд аст?', options: ['36', '108', '144', '180'], answer: '108' }
        ]
      },
      surface_area_cylinder: {
        name: "Масоҳати рӯизамини силиндр", icon: "📏",
        theory: `Масоҳати рӯизамини силиндр A = 2πr² + 2πrh аст, ки r радиус ва h баландӣ аст.`,
        learningQuestions: [
          { type: 'open', question: 'Масоҳати рӯизамини силиндр бо радиуси 2 ва баландии 3 (π = 3.14) чанд аст?', answer: '37.68' },
          { type: 'multiple-choice', question: 'Масоҳати рӯизамини силиндр бо радиуси 1 ва баландии 2 (π = 3) чанд аст?', options: ['12', '18', '24', '30'], answer: '18' }
        ]
      },
      angle_sum_polygons: {
        name: "Суммаи кунҷҳои кногона", icon: "📐",
        theory: `Суммаи кунҷҳои дохилии кногонаи n-тарафа (n-2)×180° аст. Ин барои ҳисобҳои геометрӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Суммаи кунҷҳои панҷгона чанд аст?', answer: '540°' },
          { type: 'multiple-choice', question: 'Суммаи кунҷҳои чоркунҷа чанд аст?', options: ['180°', '360°', '540°', '720°'], answer: '360°' }
        ]
      },
      slope: {
        name: "Шиб", icon: "📉",
        theory: `Шиб (m) нишон медиҳад, ки хати рост чӣ қадар тез баланд ё паст мешавад: m = (y₂ - y₁)/(x₂ - x₁). Ин дар графикҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Шиби хат бо нуқтаҳои (1,2) ва (3,6) чанд аст?', answer: '2' },
          { type: 'multiple-choice', question: 'Шиби хат бо нуқтаҳои (0,0) ва (2,4) чанд аст?', options: ['1', '2', '3', '4'], answer: '2' }
        ]
      },
      distance_formula: {
        name: "Формулаи масофа", icon: "📏",
        theory: `Масофаи байни ду нуқта (x₁,y₁) ва (x₂,y₂) бо формулаи √((x₂-x₁)² + (y₂-y₁)²) ҳисоб мешавад.`,
        learningQuestions: [
          { type: 'open', question: 'Масофаи байни (1,1) ва (4,5) чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: 'Масофаи байни (0,0) ва (3,4) чанд аст?', options: ['4', '5', '6', '7'], answer: '5' }
        ]
      },
      midpoint_formula: {
        name: "Формулаи нуқтаи миёна", icon: "📍",
        theory: `Нуқтаи миёнаи байни (x₁,y₁) ва (x₂,y₂) бо формулаи ((x₁+x₂)/2, (y₁+y₂)/2) ёфта мешавад.`,
        learningQuestions: [
          { type: 'open', question: 'Нуқтаи миёнаи (2,4) ва (6,8) кадом аст?', answer: '(4,6)' },
          { type: 'multiple-choice', question: 'Нуқтаи миёнаи (1,1) ва (3,3) кадом аст?', options: ['(1,2)', '(2,2)', '(2,3)', '(3,2)'], answer: '(2,2)' }
        ]
      },
      statistics_basics: {
        name: "Асосҳои омор", icon: "📊",
        theory: `Омор додаҳоро бо миёна, медиана, мода ва фарқият таҳлил мекунад. Ин барои фаҳмидани маълумот муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Фарқияти силсилаи 2, 5, 8 чанд аст?', answer: '6' },
          { type: 'multiple-choice', question: 'Медианаи 1, 3, 4, 6, 8 чанд аст?', options: ['3', '4', '5', '6'], answer: '4' }
        ]
      },
      probability_advanced: {
        name: "Эҳтимолияти пешрафта", icon: "🎲",
        theory: `Эҳтимолияти мураккаб ҳодисаҳои вобаста ва новобастаро меомӯзад. Барои ҳодисаҳои новобаста, P(A ва B) = P(A) × P(B).`,
        learningQuestions: [
          { type: 'open', question: 'Эҳтимолияти баромадани ду сари танга чанд аст?', answer: '1/4' },
          { type: 'multiple-choice', question: 'Эҳтимолияти баромадани 1 дар ду зар чанд аст?', options: ['1/6', '1/12', '1/36', '1/3'], answer: '1/36' }
        ]
      },
      transformations_advanced: {
        name: "Табдилҳои пешрафта", icon: "🔄",
        theory: `Табдилҳои пешрафта инъикос, гардиш, интиқол ва васеъкуниро дар бар мегиранд. Онҳо шаклҳоро тағйир медиҳанд, аммо хосиятҳоро нигоҳ медоранд.`,
        learningQuestions: [
          { type: 'open', question: 'Васеъкунӣ чист?', answer: 'Тағйири андозаи шакл бо таносуб' },
          { type: 'multiple-choice', question: 'Гардиши 180° нуқтаи (1,1)-ро ба кадом нуқта мебарад?', options: ['(1,-1)', '(-1,1)', '(-1,-1)', '(1,1)'], answer: '(-1,-1)' }
        ]
      },
      sequences: {
        name: "Силсилаҳо", icon: "🔢",
        theory: `Силсилаҳо тартиби ададҳоянд, ки бо қоидаи муайян пайдо мешаванд. Намудҳо: арифметикӣ, геометрӣ.`,
        learningQuestions: [
          { type: 'open', question: 'Адади навбатии силсилаи 2, 5, 8, ... чанд аст?', answer: '11' },
          { type: 'multiple-choice', question: 'Адади навбатии 3, 6, 12, ... чанд аст?', options: ['18', '24', '30', '36'], answer: '24' }
        ]
      }
    }
  },
  '9': {
    name: "Синфи 9",
    topics: {
      quadratics: {
        name: "Муодилаҳои квадратӣ", icon: "📈",
        theory: `Муодилаи квадратӣ шакли ax² + bx + c = 0 дорад. Решаҳо бо формулаи x = (-b ± √(b² - 4ac)) / 2a ёфта мешаванд. Дискриминант (D = b² - 4ac) шумораи решаҳоро муайян мекунад: D > 0 (ду реша), D = 0 (як реша), D < 0 (бе решаи ҳақиқӣ).`,
        learningQuestions: [
          { type: 'open', question: 'Дискриминанти муодилаи x² + 6x + 9 = 0 чанд аст?', answer: '0' },
          { type: 'multiple-choice', question: 'Решаҳои x² - 16 = 0 кадоманд?', options: ['±2', '±3', '±4', '±5'], answer: '±4' }
        ]
      },
      quadratic_graphs: {
        name: "Графикҳои квадратӣ", icon: "📉",
        theory: `Графики функсияи квадратӣ (y = ax² + bx + c) парабола аст. Вершина бо x = -b/(2a) ёфта мешавад, ва он дар таҳлили функсияҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Вершини y = x² + 4x + 3 чанд аст?', answer: '(-2,-1)' },
          { type: 'multiple-choice', question: 'y = x² - 4 дар кадом нуқта меҳвари y-ро мебурад?', options: ['(0,-4)', '(0,4)', '(4,0)', '(-4,0)'], answer: '(0,-4)' }
        ]
      },
      polynomials_advanced: {
        name: "Полиномҳои пешрафта", icon: "🔢",
        theory: `Полиномҳои дараҷаи баланд (масалан, x³ + 2x² + x + 1) бо омилкунӣ ё теоремаи решаҳо ҳал мешаванд. Онҳо дар алгебраи мураккаб муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Дараҷаи полиноми x⁴ + 2x³ + 1 чанд аст?', answer: '4' },
          { type: 'multiple-choice', question: 'x³ - x² - 2x чанд реша дорад?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      },
      rational_expressions: {
        name: "Ифодаҳои рационалӣ", icon: "🔢",
        theory: `Ифодаҳои рационалӣ касрҳоеанд, ки сурат ва махраҷашон полиноманд. Барои содда кардан, омилҳои муштаракро кӯтоҳ мекунем.`,
        learningQuestions: [
          { type: 'open', question: '(x² - 9)/(x + 3)-ро содда кунед.', answer: 'x - 3' },
          { type: 'multiple-choice', question: '(x² - 1)/(x - 1) = ?', options: ['x + 1', 'x - 1', 'x', 'x²'], answer: 'x + 1' }
        ]
      },
      radical_expressions: {
        name: "Ифодаҳои радикалӣ", icon: "√",
        theory: `Ифодаҳои радикалӣ решаҳои квадратӣ ё дараҷаи дигар доранд (масалан, √x). Барои содда кардан, омилҳои квадратии комилро берун мебарорем.`,
        learningQuestions: [
          { type: 'open', question: '√32-ро содда кунед.', answer: '4√2' },
          { type: 'multiple-choice', question: '√72 = ?', options: ['6√2', '8√2', '4√3', '9√2'], answer: '6√2' }
        ]
      },
      rational_equations: {
        name: "Муодилаҳои рационалӣ", icon: "🔣",
        theory: `Муодилаҳои рационалӣ касрҳое доранд, ки тағйирёбанда дар махраҷ аст. Барои ҳал, махраҷро тоза карда, муодиларо ҳал мекунем.`,
        learningQuestions: [
          { type: 'open', question: 'Дар муодилаи 1/x + 2 = 3, x чанд аст?', answer: '1' },
          { type: 'multiple-choice', question: '2/x = 4, x = ?', options: ['0.5', '1', '2', '4'], answer: '0.5' }
        ]
      },
      sequences_arithmetic: {
        name: "Силсилаҳои арифметикӣ", icon: "🔢",
        theory: `Силсилаи арифметикӣ ададҳое дорад, ки бо фарқияти доимӣ зиёд мешаванд (масалан, 2, 5, 8, ...). Формулаи n-ум ҳад: aₙ = a₁ + (n-1)d.`,
        learningQuestions: [
          { type: 'open', question: 'Адади 5-уми силсилаи 3, 7, 11, ... чанд аст?', answer: '19' },
          { type: 'multiple-choice', question: 'Адади 4-уми силсилаи 2, 6, 10, ... чанд аст?', options: ['12', '14', '16', '18'], answer: '14' }
        ]
      },
      sequences_geometric: {
        name: "Силсилаҳои геометрӣ", icon: "🔢",
        theory: `Силсилаи геометрӣ ададҳое дорад, ки бо таносуби доимӣ зиёд мешаванд (масалан, 2, 4, 8, ...). Формулаи n-ум ҳад: aₙ = a₁ × r^(n-1).`,
        learningQuestions: [
          { type: 'open', question: 'Адади 4-уми силсилаи 3, 6, 12, ... чанд аст?', answer: '24' },
          { type: 'multiple-choice', question: 'Адади 5-уми силсилаи 2, 6, 18, ... чанд аст?', options: ['54', '162', '486', '108'], answer: '162' }
        ]
      },
      trigonometry_ratios: {
        name: "Нисбатҳои тригонометрӣ", icon: "📐",
        theory: `Нисбатҳои тригонометрӣ (sin, cos, tan) муносибати тарафҳои секунҷаи росткунҷаро ифода мекунанд. sin = муқобил/гипотенуза, cos = муҷовир/гипотенуза, tan = муқобил/муҷовир.`,
        learningQuestions: [
          { type: 'open', question: 'Тангенс чист?', answer: 'Нисбати катети муқобил ба муҷовир' },
          { type: 'multiple-choice', question: 'sin(30°) чанд аст?', options: ['0', '1/2', '√3/2', '1'], answer: '1/2' }
        ]
      },
      trigonometric_identities: {
        name: "Айнан якхелагии тригонометрӣ", icon: "📐",
        theory: `Айнан якхелагиҳо муносибатҳои тригонометрианд (масалан, sin²θ + cos²θ = 1). Онҳо дар содда кардани ифодаҳо муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'sin²θ + cos²θ чанд аст?', answer: '1' },
          { type: 'multiple-choice', question: 'tanθ = ?', options: ['sinθ/cosθ', 'cosθ/sinθ', 'sinθ × cosθ', '1/sinθ'], answer: 'sinθ/cosθ' }
        ]
      },
      complex_numbers_basics: {
        name: "Ададҳои мураккаб", icon: "🔢",
        theory: `Ададҳои мураккаб шакли a + bi доранд, ки i² = -1. Онҳо дар ҳалли муодилаҳое, ки решаи манфӣ доранд, муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'i² чанд аст?', answer: '-1' },
          { type: 'multiple-choice', question: '2 + 3i + 1 + 2i = ?', options: ['3 + 5i', '3 + i', '5 + 3i', '1 + 5i'], answer: '3 + 5i' }
        ]
      },
      factoring_advanced: {
        name: "Омилкунии пешрафта", icon: "🔢",
        theory: `Омилкунии пешрафта полиномҳоро ба омилҳои хурд тақсим мекунад (масалан, x³ - 8 = (x - 2)(x² + 2x + 4)).`,
        learningQuestions: [
          { type: 'open', question: 'x² - 25-ро омил кунед.', answer: '(x - 5)(x + 5)' },
          { type: 'multiple-choice', question: 'x³ - 1 = ?', options: ['(x - 1)(x² + x + 1)', '(x + 1)(x² - x + 1)', '(x - 1)(x² - x + 1)', '(x + 1)(x² + x + 1)'], answer: '(x - 1)(x² + x + 1)' }
        ]
      },
      inequalities_advanced: {
        name: "Нобаробариҳои пешрафта", icon: "≠",
        theory: `Нобаробариҳои пешрафта мураккабанд (масалан, квадратик ё рационалӣ). Барои ҳал, нуқтаҳои муҳимро ёфта, минтақаҳои дурустро муайян мекунем.`,
        learningQuestions: [
          { type: 'open', question: 'x² - 4 > 0-ро ҳал кунед.', answer: 'x < -2 ё x > 2' },
          { type: 'multiple-choice', question: 'x² - 9 ≤ 0, x = ?', options: ['-3 ≤ x ≤ 3', '-2 ≤ x ≤ 2', 'x ≤ -3', 'x ≥ 3'], answer: '-3 ≤ x ≤ 3' }
        ]
      },
      systems_nonlinear: {
        name: "Системаҳои ғайрихаттӣ", icon: "🔣",
        theory: `Системаҳои ғайрихаттӣ муодилаҳои квадратӣ ё дигарро дар бар мегиранд. Усулҳо: ивазкунӣ, бартарафсозӣ.`,
        learningQuestions: [
          { type: 'open', question: 'Дар x² + y = 5, x + y = 3, x чанд аст?', answer: '1, 2' },
          { type: 'multiple-choice', question: 'x² + y = 4, x - y = 2, x = ?', options: ['1', '2', '3', '4'], answer: '2' }
        ]
      },
      exponential_functions: {
        name: "Функсияҳои экспоненсиалӣ", icon: "📈",
        theory: `Функсияҳои экспоненсиалӣ шакли y = a × b^x доранд. Онҳо дар афзоиши босуръат (масалан, фоизҳои бонкӣ) муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Агар y = 2^x ва x = 3, y чанд аст?', answer: '8' },
          { type: 'multiple-choice', question: 'y = 3^x, x = 2, y = ?', options: ['6', '9', '12', '15'], answer: '9' }
        ]
      },
      coordinate_geometry: {
        name: "Геометрияи координатӣ", icon: "📍",
        theory: `Геометрияи координатӣ шаклҳоро бо координатаҳо таҳлил мекунад. Формулаҳои масофа, нуқтаи миёна ва шиб истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Масофаи байни (1,2) ва (4,6) чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: 'Нуқтаи миёнаи (2,3) ва (6,7) кадом аст?', options: ['(4,5)', '(3,5)', '(5,4)', '(4,4)'], answer: '(4,5)' }
        ]
      },
      volume_sphere: {
        name: "Ҳаҷми сфера", icon: "🧊",
        theory: `Ҳаҷми сфера бо формулаи V = (4/3)πr³ ҳисоб мешавад, ки r радиус аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳаҷми сфера бо радиуси 3 (π = 3.14) чанд аст?', answer: '113.04' },
          { type: 'multiple-choice', question: 'Ҳаҷми сфера бо радиуси 2 (π = 3) чанд аст?', options: ['24', '32', '48', '64'], answer: '32' }
        ]
      },
      surface_area_sphere: {
        name: "Масоҳати рӯизамини сфера", icon: "📏",
        theory: `Масоҳати рӯизамини сфера бо формулаи A = 4πr² ҳисоб мешавад, ки r радиус аст.`,
        learningQuestions: [
          { type: 'open', question: 'Масоҳати рӯизамини сфера бо радиуси 2 (π = 3.14) чанд аст?', answer: '50.24' },
          { type: 'multiple-choice', question: 'Масоҳати рӯизамини сфера бо радиуси 3 (π = 3) чанд аст?', options: ['36', '108', '144', '180'], answer: '108' }
        ]
      },
      statistics_advanced: {
        name: "Омори пешрафта", icon: "📊",
        theory: `Омори пешрафта миёна, медиана, мода, дисперсия ва андозагирии стандартро дар бар мегирад. Ин барои таҳлили додаҳо муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Медианаи силсилаи 2, 4, 6, 8, 10 чанд аст?', answer: '6' },
          { type: 'multiple-choice', question: 'Миёнаи 1, 3, 5, 7 чанд аст?', options: ['3', '4', '5', '6'], answer: '4' }
        ]
      },
      probability_combinations: {
        name: "Эҳтимолият ва комбинатсия", icon: "🎲",
        theory: `Комбинатсияҳо шумораи роҳҳои интихоби ашёҳоро бидуни тартиб ҳисоб мекунанд: C(n,k) = n!/(k!(n-k)!). Ин дар эҳтимолият муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'C(5,2) чанд аст?', answer: '10' },
          { type: 'multiple-choice', question: 'C(4,3) = ?', options: ['4', '6', '8', '12'], answer: '4' }
        ]
      }
    }
  },
  '10': {
    name: "Синфи 10",
    topics: {
      logarithms: {
        name: "Логарифмҳо", icon: "🪵",
        theory: `Логарифми logₐ(N) дараҷаест, ки асоси a ба он бардошта, N-ро медиҳад. Хосиятҳо: log(ab) = log(a) + log(b), log(a/b) = log(a) - log(b).`,
        learningQuestions: [
          { type: 'open', question: 'log₂(16) чанд аст?', answer: '4' },
          { type: 'multiple-choice', question: 'log₁₀(1000) = ?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      },
      logarithmic_equations: {
        name: "Муодилаҳои логарифмӣ", icon: "🔣",
        theory: `Муодилаҳои логарифмӣ логарифм доранд (масалан, log₂(x) = 3). Барои ҳал, ба шакли экспоненсиалӣ табдил дода мешавад: x = 2³.`,
        learningQuestions: [
          { type: 'open', question: 'log₃(x) = 2, x чанд аст?', answer: '9' },
          { type: 'multiple-choice', question: 'log₂(x) = 4, x = ?', options: ['8', '16', '32', '64'], answer: '16' }
        ]
      },
      exponential_equations: {
        name: "Муодилаҳои экспоненсиалӣ", icon: "📈",
        theory: `Муодилаҳои экспоненсиалӣ дараҷаҳо доранд (масалан, 2^x = 8). Барои ҳал, логарифм ё асосҳои муштарак истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: '2^x = 16, x чанд аст?', answer: '4' },
          { type: 'multiple-choice', question: '3^x = 27, x = ?', options: ['2', '3', '4', '5'], answer: '3' }
        ]
      },
      trigonometric_functions: {
        name: "Функсияҳои тригонометрӣ", icon: "📐",
        theory: `Функсияҳои тригонометрӣ (sin, cos, tan) дар графикҳо даврӣ мебошанд. Онҳо дар физика ва муҳандисӣ муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Даври sin(x) чанд аст?', answer: '2π' },
          { type: 'multiple-choice', question: 'cos(0°) чанд аст?', options: ['0', '1/2', '1', '√3/2'], answer: '1' }
        ]
      },
      trigonometric_equations: {
        name: "Муодилаҳои тригонометрӣ", icon: "📐",
        theory: `Муодилаҳои тригонометрӣ функсияҳои тригонометриро доранд (масалан, sin(x) = 0.5). Онҳо дар доираи воҳид ҳал мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'sin(x) = 1/2, x чанд аст?', answer: '30° ё π/6' },
          { type: 'multiple-choice', question: 'cos(x) = 0, x = ?', options: ['0°', '90°', '180°', '270°'], answer: '90°' }
        ]
      },
      trigonometric_graphs: {
        name: "Графикҳои тригонометрӣ", icon: "📉",
        theory: `Графикҳои sin(x) ва cos(x) мавҷҳои даврӣ бо амплитуда ва давр мебошанд. Онҳо дар таҳлили ҳаракат муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Амплитудаи y = 2sin(x) чанд аст?', answer: '2' },
          { type: 'multiple-choice', question: 'Даври y = cos(2x) чанд аст?', options: ['π', '2π', 'π/2', '4π'], answer: 'π' }
        ]
      },
      complex_numbers_advanced: {
        name: "Ададҳои мураккаби пешрафта", icon: "🔢",
        theory: `Ададҳои мураккаб амалҳои ҷамъ, тарҳ, зарб ва тақсимро доранд. Шакли тригонометрӣ ва модул низ истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: '(2 + 3i)(1 + i) чанд аст?', answer: '-1 + 5i' },
          { type: 'multiple-choice', question: 'Модули 3 + 4i чанд аст?', options: ['5', '7', '9', '11'], answer: '5' }
        ]
      },
      matrices_basics: {
        name: "Асосҳои матрица", icon: "🔢",
        theory: `Матрицаҳо массивҳои ададҳо мебошанд, ки дар ҳалли системаи муодилаҳо ва табдилҳо истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Матрицаи 2×3 чанд унсур дорад?', answer: '6' },
          { type: 'multiple-choice', question: 'Суммаи матрицаҳои [1,2] + [3,4] чанд аст?', options: ['[4,6]', '[3,6]', '[4,5]', '[5,6]'], answer: '[4,6]' }
        ]
      },
      matrix_operations: {
        name: "Амалҳо бо матрицаҳо", icon: "🔢",
        theory: `Амалҳои матрицаҳо ҷамъ, тарҳ, зарб ва детерминантро дар бар мегиранд. Онҳо дар алгебраи хаттӣ муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Детерминанти [[1,2],[3,4]] чанд аст?', answer: '-2' },
          { type: 'multiple-choice', question: '[[1,0],[0,1]] × [2,3] = ?', options: ['[2,3]', '[1,2]', '[3,4]', '[2,0]'], answer: '[2,3]' }
        ]
      },
      conic_sections: {
        name: "Сохтҳои коникӣ", icon: "📈",
        theory: `Сохтҳои коникӣ (доира, эллипс, парабола, гипербола) аз буридани конус ба вуҷуд меоянд. Онҳо дар геометрия муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Муодилаи доира бо маркази (0,0) ва радиуси 5 чӣ аст?', answer: 'x² + y² = 25' },
          { type: 'multiple-choice', question: 'x² + y² = 16 чӣ шакл аст?', options: ['Эллипс', 'Доира', 'Парабола', 'Гипербола'], answer: 'Доира' }
        ]
      },
      parabola_properties: {
        name: "Хосиятҳои парабола", icon: "📉",
        theory: `Парабола графикаи функсияи квадратӣ аст. Он вершина, меҳвар ва фокус дорад, ки дар таҳлили он муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Фокуси y = x² чанд аст?', answer: '(0,1/4)' },
          { type: 'multiple-choice', question: 'Меҳвари y = x² кадом аст?', options: ['x = 0', 'y = 0', 'x = 1', 'y = 1'], answer: 'x = 0' }
        ]
      },
      ellipse_properties: {
        name: "Хосиятҳои эллипс", icon: "📈",
        theory: `Эллипс муодилаи (x²/a²) + (y²/b²) = 1 дорад. Он фокусҳо ва меҳварҳои калон ва хурд дорад.`,
        learningQuestions: [
          { type: 'open', question: 'Муодилаи эллипс бо меҳварҳои 4 ва 6 чӣ аст?', answer: '(x²/16) + (y²/36) = 1' },
          { type: 'multiple-choice', question: '(x²/9) + (y²/4) = 1 чӣ шакл аст?', options: ['Доира', 'Эллипс', 'Парабола', 'Гипербола'], answer: 'Эллипс' }
        ]
      },
      hyperbola_properties: {
        name: "Хосиятҳои гипербола", icon: "📈",
        theory: `Гипербола муодилаи (x²/a²) - (y²/b²) = 1 дорад. Он ду шоха ва фокусҳо дорад.`,
        learningQuestions: [
          { type: 'open', question: 'Муодилаи гипербола бо фокус дар (±5,0) ва a = 3 чӣ аст?', answer: '(x²/9) - (y²/16) = 1' },
          { type: 'multiple-choice', question: '(x²/4) - (y²/9) = 1 чӣ шакл аст?', options: ['Доира', 'Эллипс', 'Парабола', 'Гипербола'], answer: 'Гипербола' }
        ]
      },
      vector_basics: {
        name: "Асосҳои вектор", icon: "➡️",
        theory: `Векторҳо миқдорҳои самт ва андозаро доранд. Онҳо бо координатаҳо (x,y) ифода мешаванд ва дар физика муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: 'Вектори (3,4) чанд дарозӣ дорад?', answer: '5' },
          { type: 'multiple-choice', question: 'Суммаи векторҳои (1,2) + (3,4) чанд аст?', options: ['(4,6)', '(2,6)', '(4,4)', '(3,6)'], answer: '(4,6)' }
        ]
      },
      vector_operations: {
        name: "Амалҳо бо векторҳо", icon: "➡️",
        theory: `Амалҳои векторҳо ҷамъ, тарҳ ва зарби скалярро дар бар мегиранд. Онҳо дар таҳлили ҳаракат муҳиманд.`,
        learningQuestions: [
          { type: 'open', question: '2 × (1,3) чанд аст?', answer: '(2,6)' },
          { type: 'multiple-choice', question: '(2,3) - (1,1) = ?', options: ['(1,2)', '(2,1)', '(3,4)', '(1,4)'], answer: '(1,2)' }
        ]
      },
      permutations: {
        name: "Пермутацияҳо", icon: "🔢",
        theory: `Пермутацияҳо шумораи роҳҳои тартиб додани ашёҳоро ҳисоб мекунанд: P(n,k) = n!/(n-k)!. Ин дар эҳтимолият муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'P(5,2) чанд аст?', answer: '20' },
          { type: 'multiple-choice', question: 'P(4,2) = ?', options: ['6', '8', '12', '24'], answer: '12' }
        ]
      },
      combinations_advanced: {
        name: "Комбинатсияҳои пешрафта", icon: "🔢",
        theory: `Комбинатсияҳо роҳҳои интихоби ашёҳоро бидуни тартиб ҳисоб мекунанд. Формула: C(n,k) = n!/(k!(n-k)!).`,
        learningQuestions: [
          { type: 'open', question: 'C(6,3) чанд аст?', answer: '20' },
          { type: 'multiple-choice', question: 'C(5,3) = ?', options: ['10', '15', '20', '25'], answer: '10' }
        ]
      },
      probability_conditional: {
        name: "Эҳтимолияти шартӣ", icon: "🎲",
        theory: `Эҳтимолияти шартӣ имкони рух додани A, агар B рух дода бошад, аст: P(A|B) = P(A ва B)/P(B).`,
        learningQuestions: [
          { type: 'open', question: 'Эҳтимолияти баромадани 6 дар зар, агар рақами зуҷ бошад, чанд аст?', answer: '1/3' },
          { type: 'multiple-choice', question: 'P(A|B) = 1/2, P(B) = 1/4, P(A ва B) = ?', options: ['1/8', '1/4', '1/2', '1'], answer: '1/8' }
        ]
      },
      statistics_distributions: {
        name: "Тақсимотҳои омор", icon: "📊",
        theory: `Тақсимотҳо (масалан, нормалӣ) рафтори додаҳоро тавсиф мекунанд. Ин дар таҳлили додаҳои калон муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Тақсимоти нормалӣ чӣ хусусият дорад?', answer: 'Шакли зангӯла' },
          { type: 'multiple-choice', question: 'Миёнаи тақсимоти нормалӣ кадом хусусият аст?', options: ['Медиана', 'Мода', 'Марказ', 'Дисперсия'], answer: 'Марказ' }
        ]
      },
      transformations_geometry: {
        name: "Табдилҳои геометрӣ", icon: "🔄",
        theory: `Табдилҳои геометрӣ (инъикос, гардиш, интиқол, васеъкунӣ) шаклҳоро тағйир медиҳанд, аммо хосиятҳоро нигоҳ медоранд.`,
        learningQuestions: [
          { type: 'open', question: 'Гардиши 90° нуқтаи (1,2)-ро ба куҷо мебарад?', answer: '(-2,1)' },
          { type: 'multiple-choice', question: 'Инъикоси (1,1) нисбат ба y = x кадом аст?', options: ['(1,1)', '(1,-1)', '(-1,1)', '(2,2)'], answer: '(1,1)' }
        ]
      }
    }
  },
  '11': {
    name: "Синфи 11",
    topics: {
      derivatives: {
        name: "Мафҳуми ҳосила", icon: "📉",
        theory: `Ҳосила суръати тағйирёбии функсияро нишон медиҳад. Барои xⁿ, ҳосила n⋅xⁿ⁻¹ аст. Ин дар физика ва иқтисодиёт муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳосилаи y = x⁵ чанд аст?', answer: '5x⁴' },
          { type: 'multiple-choice', question: 'Ҳосилаи y = 3 чанд аст?', options: ['0', '1', '3', 'x'], answer: '0' }
        ]
      },
      derivative_rules: {
        name: "Қоидаҳои ҳосила", icon: "📉",
        theory: `Қоидаҳои ҳосила қоидаи маҳсул, тақсим ва занҷирро дар бар мегиранд. Ин барои функсияҳои мураккаб муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳосилаи (x²)(x + 1) чанд аст?', answer: '3x² + 2x' },
          { type: 'multiple-choice', question: 'Ҳосилаи x/(x + 1) чанд аст?', options: ['1/(x + 1)²', 'x/(x + 1)', '1/x', 'x²'], answer: '1/(x + 1)²' }
        ]
      },
      integrals_basics: {
        name: "Асосҳои интеграл", icon: "∫",
        theory: `Интеграл амали баръакси ҳосила аст. Интеграли naxⁿ = (ax^(n+1))/(n+1) + C. Ин дар ҳисоби масоҳат муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Интеграли 3x² чанд аст?', answer: 'x³ + C' },
          { type: 'multiple-choice', question: 'Интеграли 2x чанд аст?', options: ['x² + C', '2x² + C', 'x + C', '2x + C'], answer: 'x² + C' }
        ]
      },
      definite_integrals: {
        name: "Интегралҳои муайян", icon: "∫",
        theory: `Интеграли муайян масоҳати зери графикро аз a то b ҳисоб мекунад: ∫(a,b) f(x)dx = F(b) - F(a).`,
        learningQuestions: [
          { type: 'open', question: '∫(0,2) x dx чанд аст?', answer: '2' },
          { type: 'multiple-choice', question: '∫(1,3) 2x dx = ?', options: ['4', '8', '12', '16'], answer: '8' }
        ]
      },
      applications_derivatives: {
        name: "Татбиқи ҳосила", icon: "📉",
        theory: `Ҳосила барои ёфтани максимум, минимум, суръат ва шитоб истифода мешавад. Ин дар физика ва оптимизатсия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳосилаи y = x² - 4x + 3 дар x = 2 чанд аст?', answer: '0' },
          { type: 'multiple-choice', question: 'Ҳосилаи y = x³ дар x = 1 чанд аст?', options: ['1', '2', '3', '4'], answer: '3' }
        ]
      },
      applications_integrals: {
        name: "Татбиқи интеграл", icon: "∫",
        theory: `Интегралҳо барои ҳисоби масоҳат, ҳаҷм ва кор истифода мешаванд. Ин дар физика ва муҳандисӣ муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Интеграли ∫(0,1) x² dx масоҳати чӣ аст?', answer: '1/3' },
          { type: 'multiple-choice', question: '∫(0,2) 3x² dx = ?', options: ['8', '16', '24', '32'], answer: '8' }
        ]
      },
      trigonometric_derivatives: {
        name: "Ҳосилаҳои тригонометрӣ", icon: "📉",
        theory: `Ҳосилаҳои функсияҳои тригонометрӣ: (sin x)' = cos x, (cos x)' = -sin x, (tan x)' = sec² x.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳосилаи sin(x) чанд аст?', answer: 'cos(x)' },
          { type: 'multiple-choice', question: 'Ҳосилаи cos(x) чанд аст?', options: ['sin x', '-sin x', 'cos x', '-cos x'], answer: '-sin x' }
        ]
      },
      trigonometric_integrals: {
        name: "Интегралҳои тригонометрӣ", icon: "∫",
        theory: `Интегралҳои тригонометрӣ: ∫sin x dx = -cos x + C, ∫cos x dx = sin x + C. Ин дар ҳисобҳои мураккаб муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Интеграли cos(x) чанд аст?', answer: 'sin(x) + C' },
          { type: 'multiple-choice', question: '∫sin x dx = ?', options: ['cos x + C', '-cos x + C', 'sin x + C', '-sin x + C'], answer: '-cos x + C' }
        ]
      },
      limits_basics: {
        name: "Асосҳои лимит", icon: "➡️",
        theory: `Лимит қимати функсияро ҳангоми наздик шудан ба нуқтаи муайян нишон медиҳад. Ин асоси ҳисоби дифференсиалӣ аст.`,
        learningQuestions: [
          { type: 'open', question: 'lim(x→2) (x + 3) чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: 'lim(x→1) (x² + 1) = ?', options: ['1', '2', '3', '4'], answer: '2' }
        ]
      },
      continuity: {
        name: "Пайвастагӣ", icon: "➡️",
        theory: `Функсияи пайваста дар ҳар нуқтаи домейн бе шикаст аст. Ин дар таҳлили функсия муҳим аст.`,
        learningQuestions: [
          { type: 'open', question: 'Функсияи пайваста чӣ хусусият дорад?', answer: 'Бе шикаст дар график' },
          { type: 'multiple-choice', question: 'Оё y = 1/x дар x = 0 пайваста аст?', options: ['Ҳа', 'Не', 'Баъзан', 'Ҳамеша'], answer: 'Не' }
        ]
      },
      differential_equations_basics: {
        name: "Асосҳои муодилаҳои дифференсиалӣ", icon: "🔣",
        theory: `Муодилаҳои дифференсиалӣ ҳосилаҳоро доранд. Намуди содда: dy/dx = ky, ки ҳалли он y = Ce^(kx) аст.`,
        learningQuestions: [
          { type: 'open', question: 'Ҳалли dy/dx = 2y чӣ аст?', answer: 'y = Ce^(2x)' },
          { type: 'multiple-choice', question: 'Ҳалли dy/dx = x чанд аст?', options: ['x²/2 + C', 'x + C', 'x² + C', '2x + C'], answer: 'x²/2 + C' }
        ]
      },
      vectors_advanced: {
        name: "Векторҳои пешрафта", icon: "➡️",
        theory: `Векторҳо дар фазои сеандоза бо (x,y,z) ифода мешаванд. Амалҳо: маҳсули скаляр, векторӣ.`,
        learningQuestions: [
          { type: 'open', question: 'Маҳсули скаляри (1,2) ва (3,4) чанд аст?', answer: '11' },
          { type: 'multiple-choice', question: 'Маҳсули скаляри (2,3) ва (4,5) = ?', options: ['23', '25', '27', '29'], answer: '23' }
        ]
      },
      polar_coordinates: {
        name: "Координатаҳои қутбӣ", icon: "📍",
        theory: `Координатаҳои қутбӣ (r,θ) нуқтаро бо масофа аз макон ва кунҷ ифода мекунанд. x = r cos θ, y = r sin θ.`,
        learningQuestions: [
          { type: 'open', question: '(r = 2, θ = π/4)-ро ба координатаҳои Декарт табдил диҳед.', answer: '(√2,√2)' },
          { type: 'multiple-choice', question: '(r = 1, θ = π/2) чанд аст?', options: ['(0,1)', '(1,0)', '(0,-1)', '(-1,0)'], answer: '(0,1)' }
        ]
      },
      parametric_equations: {
        name: "Муодилаҳои параметрӣ", icon: "📈",
        theory: `Муодилаҳои параметрӣ координатаҳоро бо параметр (t) ифода мекунанд: x = f(t), y = g(t).`,
        learningQuestions: [
          { type: 'open', question: 'Агар x = t, y = t², t = 2, нуқта чанд аст?', answer: '(2,4)' },
          { type: 'multiple-choice', question: 'x = 2t, y = t + 1, t = 1 чанд аст?', options: ['(2,2)', '(1,2)', '(2,1)', '(1,1)'], answer: '(2,2)' }
        ]
      },
      probability_distributions: {
        name: "Тақсимотҳои эҳтимолият", icon: "🎲",
        theory: `Тақсимотҳои эҳтимолият (биномиалӣ, нормалӣ) рафтори тасодуфиро тавсиф мекунанд.`,
        learningQuestions: [
          { type: 'open', question: 'Тақсимоти биномиалӣ чӣ тавсиф мекунад?', answer: 'Ҳодисаҳои дуҳолатӣ' },
          { type: 'multiple-choice', question: 'Тақсимоти нормалӣ чӣ шакл дорад?', options: ['Хаттӣ', 'Зангӯла', 'Парабола', 'Гипербола'], answer: 'Зангӯла' }
        ]
      },
      statistics_regression: {
        name: "Регрессияи омор", icon: "📊",
        theory: `Регрессия муносибати байни тағйирёбандаҳоро таҳлил мекунад (масалан, регрессияи хаттӣ y = mx + c).`,
        learningQuestions: [
          { type: 'open', question: 'Регрессияи хаттӣ чӣ муайян мекунад?', answer: 'Хати беҳтарин мувофиқ' },
          { type: 'multiple-choice', question: 'Регрессияи хаттӣ чӣ муодила дорад?', options: ['y = mx + c', 'y = ax² + bx + c', 'y = a^x', 'y = sin x'], answer: 'y = mx + c' }
        ]
      },
      conic_sections_advanced: {
        name: "Сохтҳои коникии пешрафта", icon: "📈",
        theory: `Сохтҳои коникӣ (доира, эллипс, парабола, гипербола) дар координатаҳои қутбӣ ва Декарт таҳлил мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Муодилаи парабола бо фокуси (0,2) чӣ аст?', answer: 'y = (1/8)x²' },
          { type: 'multiple-choice', question: 'x²/16 + y²/9 = 1 чӣ шакл аст?', options: ['Доира', 'Эллипс', 'Парабола', 'Гипербола'], answer: 'Эллипс' }
        ]
      },
      sequences_advanced: {
        name: "Силсилаҳои пешрафта", icon: "🔢",
        theory: `Силсилаҳои пешрафта арифметикӣ, геометрӣ ва ё дигар қонуниятҳоро доранд. Суммаи силсилаҳо бо формулаҳо ҳисоб мешавад.`,
        learningQuestions: [
          { type: 'open', question: 'Суммаи 1 + 2 + 3 + ... + 10 чанд аст?', answer: '55' },
          { type: 'multiple-choice', question: 'Суммаи силсилаи 2 + 4 + 8 + ... (4 ҳад) чанд аст?', options: ['14', '30', '60', '90'], answer: '30' }
        ]
      },
      matrices_advanced: {
        name: "Матрицаҳои пешрафта", icon: "🔢",
        theory: `Матрицаҳои пешрафта амалҳои мураккаб (масалан, баръакс, детерминант) доранд, ки дар алгебраи хаттӣ истифода мешаванд.`,
        learningQuestions: [
          { type: 'open', question: 'Детерминанти [[2,1],[3,4]] чанд аст?', answer: '5' },
          { type: 'multiple-choice', question: 'Детерминанти [[1,2],[3,4]] = ?', options: ['-2', '2', '4', '6'], answer: '-2' }
        ]
      },
      complex_plane: {
        name: "Ҳамвории мураккаб", icon: "📍",
        theory: `Ҳамвории мураккаб ададҳои мураккаб (a + bi)-ро бо меҳварҳои воқеӣ (a) ва тасаввурӣ (b) ифода мекунад.`,
        learningQuestions: [
          { type: 'open', question: '3 + 4i дар ҳамвории мураккаб кадом нуқта аст?', answer: '(3,4)' },
          { type: 'multiple-choice', question: 'Модули 1 + i чанд аст?', options: ['1', '√2', '2', '√3'], answer: '√2' }
        ]
      }
    }
  }

};

// --- Маълумоти сохта барои Ҷадвали Пешсафон ---
const mockLeaderboardData = [
    { name: 'Алиҷон Валиев', score: 2500, avatar: 'https://i.pravatar.cc/150?img=1' },
    { name: 'Манижа Давлатова', score: 2350, avatar: 'https://i.pravatar.cc/150?img=2' },
    { name: 'Рустам Азимов', score: 2100, avatar: 'https://i.pravatar.cc/150?img=3' },
    { name: 'Сабрина Фирӯзова', score: 1980, avatar: 'https://i.pravatar.cc/150?img=4' },
];

// --- Icons (SVG) ---
const ClockIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>;
const CheckCircleIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-green-500"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>;
const XCircleIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-red-500"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>;
const BookmarkIcon = ({ bookmarked }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill={bookmarked ? "currentColor" : "none"} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="cursor-pointer hover:text-yellow-500 text-yellow-400"><path d="m19 21-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"></path></svg>;
const TrophyIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>;
const StarIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" className="text-yellow-500" stroke="currentColor" strokeWidth="1" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" /></svg>;
const CameraIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path><circle cx="12" cy="13" r="3"></circle></svg>;
const LeaderboardIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 16h4"/><path d="M8 11h.01"/><path d="M8 16h.01"/><rect x="8" y="2" width="8" height="4" rx="1" ry="1"/></svg>;
const PracticeIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m12 14 4-4"/><path d="M3.34 19a10 10 0 1 1 17.32 0"/><path d="m15 11-4 4"/><path d="m22 2-7 2-1.5 7.5L2 22"/></svg>;
const QuizIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>;
const HomeIcon = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>;

// --- Constants ---
const APP_STATE_KEY = 'mathOlympiadState_v2';
const TIME_PER_QUESTION = 190;

// --- Функсияҳои ёрирасон ---
const playSound = (sound) => {
    try {
        new Audio(`/sounds/${sound}.mp3`).play();
    } catch (e) {
        console.error("Error playing sound:", e);
    }
};

const getRank = (score) => {
    if (score < 10) return { name: "Навкор", color: "text-gray-500" };
    if (score < 25) return { name: "Бронза", color: "text-orange-500" };
    if (score < 50) return { name: "Нуқра", color: "text-slate-500" };
    if (score < 100) return { name: "Тилло", color: "text-yellow-500" };
    return { name: "Платина", color: "text-cyan-500" };
};

const allQuestions = Object.values(questionsData).flat();
const allCategories = [...new Set(allQuestions.map(q => q.category))];

// --- Main App Component ---
export default function App() {
    
    const loadState = () => {
        try {
            const serializedState = localStorage.getItem(APP_STATE_KEY);
            if (serializedState === null) return undefined;
            const state = JSON.parse(serializedState);
            if (!state.user || !state.user.name) {
                state.screen = 'profile_setup';
            }
            return state;
        } catch (err) {
            console.error("Could not load state", err);
            return undefined;
        }
    };

    const initialState = loadState() || {
        screen: 'profile_setup',
        user: { name: '', profilePic: null },
        quizMode: 'timed',
        selectedClass: null,
        currentQuestionIndex: 0,
        questionsForCurrentSession: [],
        sessionAnswers: [], 
        bookmarks: [],
        userStats: {
            totalCorrect: 0,
            totalWrong: 0,
            badges: [],
            statsByCategory: {},
        },
    };
    
    const [screen, setScreen] = useState(initialState.screen);
    const [user, setUser] = useState(initialState.user);
    const [quizMode, setQuizMode] = useState(initialState.quizMode);
    const [selectedClass, setSelectedClass] = useState(initialState.selectedClass);
    const [currentQuestionIndex, setCurrentQuestionIndex] = useState(initialState.currentQuestionIndex);
    const [questionsForCurrentSession, setQuestionsForCurrentSession] = useState(initialState.questionsForCurrentSession);
    const [sessionAnswers, setSessionAnswers] = useState(initialState.sessionAnswers);  
    const [selectedOption, setSelectedOption] = useState(null);
    const [feedback, setFeedback] = useState(null);
    const [bookmarks, setBookmarks] = useState(initialState.bookmarks);
    const [userStats, setUserStats] = useState(initialState.userStats);
    const [timeLeft, setTimeLeft] = useState(TIME_PER_QUESTION);

    useEffect(() => {
        const stateToSave = {
            screen: (screen === 'profile_setup') ? 'welcome' : screen,
            user, quizMode, selectedClass, currentQuestionIndex, questionsForCurrentSession,
            sessionAnswers, bookmarks, userStats,
        };
        try {
            localStorage.setItem(APP_STATE_KEY, JSON.stringify(stateToSave));
        } catch (err) {
            console.error("Could not save state", err);
        }
    }, [screen, user, quizMode, selectedClass, currentQuestionIndex, questionsForCurrentSession, sessionAnswers, bookmarks, userStats]);

    const currentQuestion = useMemo(() => questionsForCurrentSession[currentQuestionIndex], [questionsForCurrentSession, currentQuestionIndex]);

    const handleProfileSave = (name, profilePic) => {
        setUser({ name, profilePic });
        setScreen('welcome');
    };

    const startQuizSession = (questions, mode) => {
        if (questions.length === 0) {
            alert("Барои ин интихоб саволҳо ёфт нашуд!");
            return;
        }
        setQuestionsForCurrentSession(questions);
        setQuizMode(mode);
        setCurrentQuestionIndex(0);
        setSessionAnswers([]);
        setFeedback(null);
        setSelectedOption(null);
        setTimeLeft(TIME_PER_QUESTION);
        setScreen('quiz');
    };

    const handleStartTimedQuiz = (grade) => {
        setSelectedClass(grade);
        startQuizSession(questionsData[grade] || [], 'timed');
    };

    const handleStartPractice = (category) => {
        const practiceQuestions = allQuestions.filter(q => q.category === category);
        startQuizSession(practiceQuestions, 'practice');
    };
    
    const handleAnswer = useCallback((option, timedOut = false) => {
        if (feedback) return;

        const answer = timedOut ? "Вақт тамом шуд" : option;
        const isCorrect = !timedOut && (option === currentQuestion.answer);
        
        if (isCorrect) playSound('correct'); else playSound('wrong');

        setSessionAnswers(prev => [...prev, { 
            questionId: currentQuestion.id, questionText: currentQuestion.question, 
            answer, isCorrect, correctAnswer: currentQuestion.answer
        }]);

        setFeedback({
            correct: isCorrect,
            explanation: currentQuestion.explanation,
            correctAnswer: currentQuestion.answer,
        });
        
        setUserStats(prev => {
            const category = currentQuestion.category;
            const newStatsByCategory = { ...prev.statsByCategory };
            if (!newStatsByCategory[category]) {
                newStatsByCategory[category] = { correct: 0, wrong: 0 };
            }

            if (isCorrect) {
                newStatsByCategory[category].correct += 1;
                return {
                    ...prev,
                    totalCorrect: prev.totalCorrect + 1,
                    statsByCategory: newStatsByCategory,
                };
            } else {
                newStatsByCategory[category].wrong += 1;
                return {
                    ...prev,
                    totalWrong: prev.totalWrong + 1,
                    statsByCategory: newStatsByCategory,
                };
            }
        });

    }, [feedback, currentQuestion]);

    const handleNextQuestion = () => {
        if (currentQuestionIndex < questionsForCurrentSession.length - 1) {
            setCurrentQuestionIndex(prev => prev + 1);
            setSelectedOption(null);
            setFeedback(null);
            setTimeLeft(TIME_PER_QUESTION);
        } else {
            playSound('finish');
            setScreen('dashboard');
        }
    };

    const toggleBookmark = (questionId) => {
        setBookmarks(prev => 
            prev.includes(questionId) 
                ? prev.filter(id => id !== questionId) 
                : [...prev, questionId]
        );
    };
    
    const resetSession = () => {
        setSessionAnswers([]);
        setScreen('welcome');
    };

    // --- Компонентҳои Саҳифаҳо ---

    const ProfileSetupScreen = () => {
        const [name, setName] = useState('');
        const [pic, setPic] = useState(null);
        const [error, setError] = useState('');

        const handleImageChange = (e) => {
            if (e.target.files && e.target.files[0]) {
                const reader = new FileReader();
                reader.onload = (event) => setPic(event.target.result);
                reader.readAsDataURL(e.target.files[0]);
            }
        };

        const handleSubmit = (e) => {
            e.preventDefault();
            if (name.trim() === '') {
                setError('Лутфан, номи худро ворид кунед.');
                return;
            }
            handleProfileSave(name.trim(), pic);
        };
        
        return (
            <div className="w-full max-w-md mx-auto bg-white p-8 rounded-2xl shadow-2xl fade-in">
                <h2 className="text-2xl sm:text-3xl font-bold mb-6 text-center text-gray-800">Сохтани профил</h2>
                <form onSubmit={handleSubmit} className="space-y-6">
                    <div className="flex flex-col items-center space-y-4">
                        <div className="relative">
                            <img 
                                src={pic || 'https://i.pravatar.cc/150'} 
                                alt="Profile" 
                                className="w-32 h-32 rounded-full object-cover border-4 border-gray-200"
                            />
                            <label htmlFor="file-input" className="absolute bottom-0 right-0 bg-indigo-600 p-2 rounded-full cursor-pointer hover:bg-indigo-700 text-white">
                                <CameraIcon />
                            </label>
                            <input id="file-input" type="file" accept="image/*" onChange={handleImageChange} className="hidden" />
                        </div>
                    </div>
                     <div>
                        <label htmlFor="name" className="block text-sm font-medium text-gray-700 mb-1">Ном ва насаб</label>
                        <input
                            type="text"
                            id="name"
                            value={name}
                            onChange={(e) => setName(e.target.value)}
                            className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500"
                            placeholder="Масалан, Фирдавсӣ Аминзода"
                        />
                    </div>
                    {error && <p className="text-red-500 text-sm text-center">{error}</p>}
                    <button type="submit" className="w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md hover:bg-indigo-700 transition-all">
                        Захира кардан
                    </button>
                </form>
            </div>
        );
    };

    const WelcomeScreen = () => (
        <div className="text-center max-w-4xl mx-auto fade-in">
             <div className="mb-8">
                <img src={user.profilePic || 'https://i.pravatar.cc/150'} alt="Profile" className="w-24 h-24 rounded-full mx-auto mb-4 border-4 border-white shadow-lg"/>
                <h1 className="text-3xl sm:text-4xl font-bold text-gray-800">Хуш омадед, {user.name}!</h1>
                <p className="text-lg text-gray-600 mt-2">Барои оғоз яке аз реҷаҳоро интихоб кунед.</p>
             </div>
             <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                <button onClick={() => setScreen('class_select')} className="menu-button">
                    <QuizIcon className="menu-button-icon"/>
                    <h2 className="menu-button-title">Викторинаи вақтдор</h2>
                    <p className="menu-button-description">Дониши худро дар реҷаи имтиҳонӣ санҷед.</p>
                </button>
                <button onClick={() => setScreen('practice_setup')} className="menu-button">
                    <PracticeIcon className="menu-button-icon"/>
                    <h2 className="menu-button-title">Реҷаи Машқ</h2>
                    <p className="menu-button-description">Мавзӯъҳои мушаххасро бидуни маҳдудияти вақт машқ кунед.</p>
                </button>
                <button onClick={() => setScreen('learning_topics')} className="menu-button">
                    <StarIcon className="menu-button-icon"/>
                    <h2 className="menu-button-title">Мавзӯъҳои омӯзиш</h2>
                    <p className="menu-button-description">Мавзуъҳоро хонед то ҳаматарафа пешрави кунед</p>
                </button>
                <button onClick={() => setScreen('leaderboard')} className="menu-button">
                    <LeaderboardIcon className="menu-button-icon"/>
                    <h2 className="menu-button-title">Ҷадвали Пешсафон</h2>
                    <p className="menu-button-description">Рейтинги худро дар байни дигарон бубинед.</p>
                </button>
             </div>
        </div>
    );

    const ClassSelectScreen = () => (
        <div className="text-center w-full max-w-4xl mx-auto fade-in">
            <h2 className="text-2xl sm:text-3xl font-bold mb-6 text-gray-800">Синфи худро интихоб кунед:</h2>
            <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                {Object.keys(questionsData).map(grade => (
                    <button
                        key={grade}
                        onClick={() => handleStartTimedQuiz(grade)}
                        disabled={!questionsData[grade] || questionsData[grade].length === 0}
                        className={`p-4 sm:p-6 text-xl sm:text-2xl font-bold rounded-lg shadow-md transition-all ${(!questionsData[grade] || questionsData[grade].length === 0) ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-white hover:bg-indigo-500 hover:text-white hover:shadow-xl transform hover:-translate-y-1'}`}
                    >
                        Синфи {grade}
                        {(!questionsData[grade] || questionsData[grade].length === 0) && <span className="block text-xs font-normal">(ба зудӣ)</span>}
                    </button>
                ))}
            </div>
        </div>
    );
    
    const PracticeSetupScreen = () => (
        <div className="text-center w-full max-w-4xl mx-auto fade-in">
            <h2 className="text-2xl sm:text-3xl font-bold mb-6 text-gray-800">Мавзӯъро барои машқ интихоб кунед:</h2>
            <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                {allCategories.map(category => (
                    <button key={category} onClick={() => handleStartPractice(category)} className='p-4 sm:p-6 text-xl font-bold rounded-lg shadow-md transition-all bg-white hover:bg-indigo-500 hover:text-white hover:shadow-xl transform hover:-translate-y-1'>
                        {category}
                    </button>
                ))}
            </div>
        </div>
    );

   const LearningTopicsScreen = () => {
    const [selectedGrade, setSelectedGrade] = useState(null);
    const [currentTopicIndex, setCurrentTopicIndex] = useState(0); // Ҳолат барои мавзӯи ҷорӣ

    // Функсия барои гузариш ба мавзӯи навбатӣ
    const handleNextTopic = () => {
        if (selectedGrade && currentTopicIndex < Object.keys(gradeData[selectedGrade].topics).length - 1) {
            setCurrentTopicIndex(prev => prev + 1);
            playSound('next'); // Садои гузариш (ихтиёрӣ)
        } else {
            // Агар мавзӯъ охирин бошад, ба корбар пешниҳод кунем ба синфи дигар ё саҳифаи асосӣ баргардад
            alert("Ин охирин мавзӯъ буд! Шумо метавонед ба синфи дигар гузаред ё ба саҳифаи асосӣ баргардед.");
        }
    };

    // Функсия барои бозгашт ба мавзӯи қаблӣ
    const handlePreviousTopic = () => {
        if (currentTopicIndex > 0) {
            setCurrentTopicIndex(prev => prev - 1);
            playSound('next'); // Садои гузариш (ихтиёрӣ)
        }
    };

    // Функсия барои бозгашт ба интихоби синф
    const handleBackToGrades = () => {
        setSelectedGrade(null);
        setCurrentTopicIndex(0); // Аз нав ба мавзӯи аввал баргардонем
    };

    return (
        <div className="text-center w-full max-w-4xl mx-auto fade-in">
            <h2 className="text-2xl sm:text-3xl font-bold mb-6 text-gray-800">Мавзӯъҳои омӯзиш</h2>
            {!selectedGrade ? (
                <div className="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4">
                    {Object.keys(gradeData).map(grade => (
                        <button
                            key={grade}
                            onClick={() => setSelectedGrade(grade)}
                            className="p-4 sm:p-6 text-xl sm:text-2xl font-bold rounded-lg shadow-md transition-all bg-white hover:bg-indigo-500 hover:text-white hover:shadow-xl transform hover:-translate-y-1"
                        >
                            {gradeData[grade].name}
                        </button>
                    ))}
                </div>
            ) : (
                <div className="bg-white p-6 rounded-2xl shadow-xl">
                    <h3 className="text-2xl font-semibold mb-4">{gradeData[selectedGrade].name}</h3>
                    {/* Намоиши танҳо мавзӯи ҷорӣ */}
                    {(() => {
                        const topicId = Object.keys(gradeData[selectedGrade].topics)[currentTopicIndex];
                        const topic = gradeData[selectedGrade].topics[topicId];
                        return (
                            <div key={topicId} className="border rounded-lg p-4 bg-gray-50">
                                <h4 className="text-xl font-semibold mb-2 flex items-center">
                                    <span className="mr-2">{topic.icon}</span> {topic.name}
                                </h4>
                                <p className="text-gray-700 mb-4">{topic.theory}</p>
                                <h5 className="font-semibold mb-2">Саволҳои омӯзишӣ:</h5>
                                <div className="space-y-3">
                                    {topic.learningQuestions.map((q, index) => (
                                        <div key={index} className="p-3 bg-white rounded-lg border">
                                            <p className="font-medium">{q.question}</p>
                                            {q.type === 'open' ? (
                                                <p className="text-green-600">Ҷавоб: {q.answer}</p>
                                            ) : (
                                                <div>
                                                    {q.options.map((option, i) => (
                                                        <p key={i} className={option === q.answer ? 'text-green-600 font-semibold' : 'text-gray-600'}>
                                                            {option}
                                                        </p>
                                                    ))}
                                                </div>
                                            )}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        );
                    })()}
                    {/* Тугмаҳои навигатсия */}
                    <div className="flex justify-between mt-6">
                        <button
                            onClick={handlePreviousTopic}
                            disabled={currentTopicIndex === 0}
                            className={`bg-gray-300 text-gray-700 font-bold py-3 px-6 rounded-lg text-lg shadow-md transition-all ${currentTopicIndex === 0 ? 'cursor-not-allowed' : 'hover:bg-gray-400'}`}
                        >
                            Қаблӣ
                        </button>
                        <button
                            onClick={handleNextTopic}
                            className="bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md hover:bg-indigo-700 transition-all"
                        >
                            Баъдӣ
                        </button>
                    </div>
                    <button
                        onClick={handleBackToGrades}
                        className="mt-4 bg-red-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md hover:bg-red-600 transition-all"
                    >
                        Бозгашт ба интихоби синф
                    </button>
                </div>
            )}
        </div>
    );
};
    
    const QuizScreen = () => {
        const progressPercentage = ((currentQuestionIndex + 1) / questionsForCurrentSession.length) * 100;
        return (
            <div className="w-full max-w-3xl mx-auto fade-in prevent-copy">
                <div className="bg-white p-5 sm:p-8 rounded-2xl shadow-2xl">
                    <div className="mb-4">
                         <div className="flex justify-between items-center mb-2 text-sm text-gray-600">
                             <span>Саволи {currentQuestionIndex + 1} аз {questionsForCurrentSession.length}</span>
                             {quizMode === 'timed' && (
                                <div className="flex items-center gap-2">
                                    <ClockIcon/>
                                    <span className="font-bold text-lg text-red-500">{timeLeft}с</span>
                                </div>
                             )}
                         </div>
                         <div className="w-full bg-gray-200 rounded-full h-2.5">
                             <div className="bg-indigo-600 h-2.5 rounded-full transition-all duration-500" style={{ width: `${progressPercentage}%` }}></div>
                         </div>
                    </div>
                    
                    <div className="flex justify-between items-start mb-6">
                        <span className="text-lg font-bold text-indigo-600">{quizMode === 'timed' ? `Синфи ${selectedClass}` : `Машқ: ${currentQuestion.category}`}</span>
                         <div onClick={() => toggleBookmark(currentQuestion.id)} title="Ба хотир гирифтан">
                           <BookmarkIcon bookmarked={bookmarks.includes(currentQuestion.id)} />
                         </div>
                    </div>
                    <p className="text-xl sm:text-2xl font-semibold text-gray-800 mb-6 min-h-[6rem] flex items-center">{currentQuestion.question}</p>
                    
                     <div className="space-y-3">
                         {currentQuestion.options.map((option, index) => (
                             <button key={index} onClick={() => !feedback && setSelectedOption(option)} disabled={!!feedback} className={`w-full text-left p-4 rounded-lg border-2 text-lg transition-all ${feedback ? (option === currentQuestion.answer ? 'bg-green-100 border-green-400' : (option === selectedOption ? 'bg-red-100 border-red-400' : 'bg-gray-100 border-gray-300 cursor-default')) : (selectedOption === option ? 'bg-indigo-100 border-indigo-500' : 'bg-white hover:bg-indigo-50 border-gray-300')}`}>
                                 {option}
                             </button>
                         ))}
                     </div>

                    {feedback ? (
                        <div className="mt-6 p-4 rounded-lg bg-gray-50 fade-in">
                            <div className="flex items-center mb-2">
                                {feedback.correct ? <CheckCircleIcon /> : <XCircleIcon />}
                                <h3 className="ml-2 text-xl font-bold">{feedback.correct ? 'Ҷавоби дуруст!' : 'Хатогӣ!'}</h3>
                            </div>
                            {!feedback.correct && <p className="text-gray-700">Ҷавоби дуруст: <strong className="text-green-600">{feedback.correctAnswer}</strong></p>}
                            <p className="text-gray-600 mt-2">{feedback.explanation}</p>
                            <button onClick={handleNextQuestion} className="w-full mt-4 bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md hover:bg-indigo-700 transition-all">
                                {currentQuestionIndex < questionsForCurrentSession.length - 1 ? 'Саволи навбатӣ' : 'Дидани натиҷаҳо'}
                            </button>
                        </div>
                    ) : (
                        <button onClick={() => handleAnswer(selectedOption)} disabled={selectedOption === null} className="w-full mt-8 bg-green-500 text-white font-bold py-3 px-6 rounded-lg text-lg shadow-md hover:bg-green-600 disabled:bg-gray-400 disabled:cursor-not-allowed transition-all">
                            Тасдиқ кардан
                        </button>
                    )}
                </div>
            </div>
        )
    };

    const Dashboard = () => {
        const correctCount = sessionAnswers.filter(a => a.isCorrect).length;
        const totalCount = sessionAnswers.length;
        const accuracy = totalCount > 0 ? ((correctCount / totalCount) * 100).toFixed(0) : 0;
        const rank = getRank(userStats.totalCorrect);

        return (
            <div className="w-full max-w-5xl mx-auto fade-in">
                <h2 className="text-3xl font-bold mb-6 text-center text-gray-800">{totalCount > 0 ? "Натиҷаҳои даври охирин" : "Панели шахсӣ"}</h2>
                
                {totalCount > 0 && (
                     <div className="bg-white p-6 rounded-2xl shadow-xl mb-8">
                        <h3 className="text-2xl font-semibold mb-4 text-center">Хулосаи бозӣ</h3>
                         <div className="grid grid-cols-1 sm:grid-cols-3 gap-4 text-center">
                            <div className="bg-blue-50 p-4 rounded-lg"><p className="text-lg text-blue-800">Саволҳо</p><p className="text-4xl font-bold text-blue-900">{totalCount}</p></div>
                           <div className="bg-green-50 p-4 rounded-lg"><p className="text-lg text-green-800">Дуруст</p><p className="text-4xl font-bold text-green-900">{correctCount}</p></div>
                            <div className="bg-yellow-50 p-4 rounded-lg"><p className="text-lg text-yellow-800">Саҳеҳӣ</p><p className="text-4xl font-bold text-yellow-900">{accuracy}%</p></div>
                         </div>
                         <div className="mt-6">
                            <h4 className="font-semibold text-center mb-2">Таҳлили хатогиҳо</h4>
                            <div className="space-y-3 max-h-48 overflow-y-auto pr-2 custom-scrollbar">
                                {sessionAnswers.filter(a => !a.isCorrect).map((a, i) => (
                                    <div key={i} className="bg-red-50 p-3 rounded-lg border border-red-200 text-sm"><p className="font-semibold text-gray-700">{a.questionText}</p><p className="text-red-700">Ҷавоби шумо: {a.answer}</p><p className="text-green-700">Ҷавоби дуруст: {a.correctAnswer}</p></div>
                                ))}
                                {totalCount > 0 && sessionAnswers.every(a => a.isCorrect) && <p className="text-center text-gray-500 p-4">Дар ин давр хато набуд. Офарин!</p>}
                            </div>
                         </div>
                     </div>
                )}

                <div className="grid md:grid-cols-2 gap-8">
                    <div className="bg-white p-6 rounded-2xl shadow-xl">
                        <h3 className="text-2xl font-semibold mb-4">Омори умумӣ</h3>
                         <div className="space-y-4">
                            <div className="flex items-center justify-between p-3 bg-gray-100 rounded-lg"><div className="flex items-center"><TrophyIcon className="mr-3" /><span className="font-medium text-gray-800">Рутбаи шумо:</span></div><span className={`font-bold text-lg ${rank.color}`}>{rank.name}</span></div>
                             <div className="flex items-center justify-between p-3 bg-gray-100 rounded-lg"><span className="font-medium text-gray-800">Ҷавобҳои дурусти умумӣ:</span><span className="font-bold text-lg text-green-600">{userStats.totalCorrect}</span></div>
                             <div className="flex items-center justify-between p-3 bg-gray-100 rounded-lg"><span className="font-medium text-gray-800">Хатогиҳои умумӣ:</span><span className="font-bold text-lg text-red-600">{userStats.totalWrong}</span></div>
                             <button onClick={() => setScreen('bookmarks_review')} className="w-full text-left flex items-center p-3 bg-yellow-100 rounded-lg hover:bg-yellow-200 transition"><BookmarkIcon bookmarked={true}/><span className="ml-3 font-medium text-yellow-800">Баррасии саволҳои захирашуда ({bookmarks.length})</span></button>
                         </div>
                    </div>
                     <div className="bg-white p-6 rounded-2xl shadow-xl">
                        <h3 className="text-2xl font-semibold mb-4">Самаранокӣ аз рӯи намуд</h3>
                        <div className="space-y-3">
                            {Object.keys(userStats.statsByCategory).length > 0 ? Object.entries(userStats.statsByCategory).map(([category, stats]) => {
                                const total = stats.correct + stats.wrong;
                                const accuracy = total > 0 ? Math.round((stats.correct / total) * 100) : 0;
                                return (
                                    <div key={category}><div className="flex justify-between items-center mb-1 text-sm font-medium"><span>{category}</span><span>{accuracy}% ({stats.correct}/{total})</span></div><div className="progress-bar"><div className="progress-bar-inner" style={{ width: `${accuracy}%` }}></div></div></div>
                                );
                            }) : <p className="text-center text-gray-500 p-4">Ҳоло омор вуҷуд надорад.</p>}
                        </div>
                    </div>
                </div>
                 <div className="text-center mt-8">
                     <button onClick={resetSession} className="bg-indigo-600 text-white font-bold py-3 px-8 rounded-full text-lg shadow-lg hover:bg-indigo-700 transition-transform transform hover:scale-105">Ба саҳифаи асосӣ</button>
                 </div>
            </div>
        );
    };

    const LeaderboardScreen = () => {
        const currentUserData = { name: `${user.name} (Шумо)`, score: userStats.totalCorrect * 10, avatar: user.profilePic };
        const combinedData = [...mockLeaderboardData, currentUserData].sort((a, b) => b.score - a.score);

        return (
            <div className="w-full max-w-2xl mx-auto bg-white p-6 sm:p-8 rounded-2xl shadow-2xl fade-in">
                <h2 className="text-3xl font-bold mb-6 text-center text-gray-800 flex items-center justify-center"><LeaderboardIcon className="w-8 h-8 mr-3"/> Ҷадвали Пешсафон</h2>
                <div className="space-y-4">
                    {combinedData.map((player, index) => (
                        <div key={index} className={`flex items-center p-3 rounded-lg transition-all ${player.name.includes('(Шумо)') ? 'bg-indigo-100 border-2 border-indigo-400 scale-105' : 'bg-gray-50'}`}><span className="text-xl font-bold text-gray-500 w-8">{index + 1}</span><img src={player.avatar || 'https://i.pravatar.cc/150'} alt={player.name} className="w-12 h-12 rounded-full mx-4 border-2 border-white"/><span className="font-semibold text-lg text-gray-800 flex-grow">{player.name}</span><span className="font-bold text-xl text-indigo-600">{player.score} хол</span></div>
                    ))}
                </div>
                <p className="text-center text-sm text-gray-500 mt-6">Эзоҳ: Холҳо = (ҷавобҳои дуруст) x 10. Ин ҷадвал барои намуна аст.</p>
            </div>
        );
    };

    const BookmarksReviewScreen = () => {
        const bookmarkedQuestions = allQuestions.filter(q => bookmarks.includes(q.id));
        return (
             <div className="w-full max-w-3xl mx-auto bg-white p-6 sm:p-8 rounded-2xl shadow-2xl fade-in">
                <h2 className="text-3xl font-bold mb-6 text-center text-gray-800 flex items-center justify-center"><BookmarkIcon bookmarked={true} /><span className="ml-3">Саволҳои захирашуда</span></h2>
                <div className="space-y-6 max-h-[70vh] overflow-y-auto custom-scrollbar pr-3">
                    {bookmarkedQuestions.length > 0 ? bookmarkedQuestions.map(q => (
                        <div key={q.id} className="p-4 border rounded-lg bg-gray-50"><p className="font-bold text-lg text-gray-800 mb-2">{q.question}</p><p className="text-green-600 font-semibold">Ҷавоби дуруст: {q.answer}</p><p className="text-sm text-gray-600 mt-1">Шарҳ: {q.explanation}</p></div>
                    )) : (<p className="text-center text-gray-500 py-10">Шумо ягон саволро захира накардаед.</p>)}
                </div>
            </div>
        );
    };

    const Header = () => (
        <header className="fixed top-0 left-0 right-0 p-3 bg-white/80 backdrop-blur-sm z-20 shadow-sm">
            <div className="container mx-auto flex justify-between items-center max-w-7xl px-4">
                <div className="text-2xl font-bold text-indigo-700 cursor-pointer flex items-center gap-2" onClick={() => setScreen('welcome')}><HomeIcon/> <span className="hidden sm:inline">MathOlimp</span></div>
                <button onClick={() => setScreen('dashboard')} className="flex items-center gap-3 bg-white pl-2 pr-4 py-1.5 rounded-full shadow-md hover:bg-gray-100 transition-all" title="Панели шахсӣ"><img src={user.profilePic || 'https://i.pravatar.cc/150'} alt="Profile" className="w-9 h-9 rounded-full object-cover border-2 border-indigo-200"/><span className="hidden md:inline font-semibold text-gray-700">{user.name}</span></button>
            </div>
        </header>
    );

    const renderScreen = () => {
        switch(screen) {
            case 'profile_setup': return <ProfileSetupScreen/>;
            case 'welcome': return <WelcomeScreen/>;
            case 'class_select': return <ClassSelectScreen/>;
            case 'practice_setup': return <PracticeSetupScreen/>;
            case 'learning_topics': return <LearningTopicsScreen/>;
            case 'quiz': return currentQuestion ? <QuizScreen/> : <p>Савол ёфт нашуд...</p>;
            case 'dashboard': return <Dashboard/>;
            case 'leaderboard': return <LeaderboardScreen/>;
            case 'bookmarks_review': return <BookmarksReviewScreen/>;
            default: return <WelcomeScreen/>;
        }
    };
    
    return (
        <div className="min-h-screen flex items-center justify-center p-4 font-sans relative">
            {screen !== 'profile_setup' && user.name && <Header />}
            <main className="w-full pt-20">
                {renderScreen()}
            </main>
        </div>
    );
}